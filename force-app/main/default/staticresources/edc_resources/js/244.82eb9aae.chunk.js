"use strict";(self.webpackChunkedc_widgets_sfdc=self.webpackChunkedc_widgets_sfdc||[]).push([[244],{9467:(e,l,a)=>{a.d(l,{Z:()=>n});a(1649);var r=a(2143),o=a(3442),d=a(5490),t=a(7064),s=a(8170);const n=e=>{let{goBack:l}=e;const a=(0,o.s0)();return(0,s.jsx)("div",{className:"edc-position-relative edc-back-button",children:(0,s.jsxs)("div",{onClick:()=>{"function"!==typeof l?a(-1):l()},className:"edc-d-flex edc-pointer edc-align-items-center edc-gap-one-fourth edc-back-button-icon-and-text",children:[(0,s.jsx)("span",{className:"edc-d-inline-flex",children:(0,s.jsx)(r.ArrowBackwardIcon,{width:10,height:20})}),(0,s.jsx)("span",{children:(0,t.TB)({key:"back",defaultTranslatedValue:d.p.Search.back})})]})})}},8244:(e,l,a)=>{a.r(l),a.d(l,{default:()=>B});var r=a(1649),o=a(2143),d=a(5422),t=a.n(d),s=a(3442),n=a(9467),i=a(2856),u=a(5490),c=a(8984),b=a(744),_=a(8079);const v=async function(){let{query:e="",orgInfo:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a="".concat(i.default.LXP_RESOURCES.SEARCH_TOPICS,"?query=").concat(e,"&per_page=500&fields=id%2Clabel%2Cname");return await(0,b.x)({url:a,domain:(0,_.Ft)({orgInfo:l}),requestType:i.default.HTTP_METHOD.GET})};var p=a(7064),f=a(8170);const L=e=>{let{handleSetSearchParams:l}=e;const[a,d]=(0,r.useState)([]),[t,s]=(0,r.useState)([]),[n,_]=(0,r.useState)(!1),[L,h]=(0,r.useState)(""),[k,g]=(0,r.useState)(""),[m,T]=(0,r.useState)(!1),[B,S]=(0,r.useState)(""),[y,w]=(0,r.useState)(!1),[x,C]=(0,r.useState)([]),{orgInfo:E,rootElement:R}=(0,r.useContext)(c.Il),F=(0,r.useCallback)((e=>{S(e),l({from_date:(null===e||void 0===e?void 0:e.startDate)||"",to_date:(null===e||void 0===e?void 0:e.endDate)||""})}),[l]),P=(0,r.useCallback)((e=>{T(e)}),[]),I=(0,r.useCallback)((async e=>{if(0===e.length){g(""),h("");(async()=>{let e=await v({orgInfo:E});const l=null===e||void 0===e?void 0:e.filter((e=>null===e||void 0===e?void 0:e.topics)),a=l.length>0?l[0].topics:[];d(a)})()}else{h(e);let l=await v({query:e,orgInfo:E});const a=null===l||void 0===l?void 0:l.filter((e=>null===e||void 0===e?void 0:e.topics)),r=a.length>0?a[0].topics:[];d(r)}}),[E]),O=(0,r.useCallback)((e=>{g(e),h(e),T(!1),l({expertise_names:[e]})}),[l]),V=(0,r.useCallback)((()=>{g(""),h(""),l({expertise_names:[]})}),[l]),A=(0,r.useCallback)((e=>{_(e)}),[]),D=(0,r.useCallback)(((e,l)=>{if(e&&!t.includes(l)){const e=[...t,l];s(e)}else{const e=t.filter((e=>e!==l));s(e)}}),[t]),M=(0,r.useCallback)((()=>{s([])}),[]),J=(0,r.useCallback)((()=>{A(!1),t.length?l({group_ids:t.toString().split(",")}):l({group_ids:[]})}),[t,A,l]),N=(0,r.useCallback)(((e,l)=>{g(e&&k!==l?l:"")}),[k]),j=(0,r.useCallback)((()=>{w(!1)}),[]),U=(0,r.useCallback)((()=>{w(!1)}),[]),G=(0,r.useCallback)((()=>{w(!1)}),[]),H=(0,r.useCallback)((()=>{w(!0)}),[]),q=(0,r.useMemo)((()=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(o.PrimaryButton,{text:(0,p.Jb)({key:"reset",defaultTranslatedValue:u.p.LeaderBoard.reset_button_text_label}),variant:i.default.BUTTONS_VARIANTS.OUTLINED,className:"edc-my-2 edc-ml-0 edc-dropdown-picker-footer-btn edc-text-secondary edc-dropdown-picker-reset-btn edc-text-sm",onClick:M},1),(0,f.jsx)(o.PrimaryButton,{text:(0,p.Jb)({key:"save",defaultTranslatedValue:u.p.LeaderBoard.save_group_button_text_label}),className:"edc-my-2 edc-ml-0 edc-dropdown-picker-footer-btn edc-text-sm",onClick:J},2)]})),[M,J]);return(0,r.useEffect)((()=>{(async()=>{let e=await v({orgInfo:E});const l=null===e||void 0===e?void 0:e.filter((e=>null===e||void 0===e?void 0:e.topics)),a=l.length>0?l[0].topics:[];d(a);let r=await(async()=>{const e="".concat(i.default.LXP_RESOURCES.GROUP,"?limit=500&offset=0");return await(0,b.x)({url:e,requestType:i.default.HTTP_METHOD.GET})})();const o=r.length>0?r[0].teams:[];C(o)})()}),[E]),(0,f.jsx)(o.LeaderboardFilterSection,{isModalOpen:y,groupFilterShowOptions:n,groupFilterSelectedOptions:t,handleGroupFilterDropdownOpen:A,handleGroupFilterCheckboxChange:D,dateFilterChangeDateCallback:F,dateFilterData:{dateSubTitle:"",dateTitle:"",placeholder:(0,p.Jb)({key:"datePlaceholder",defaultTranslatedValue:u.p.LeaderBoard.date_filter_placeholder})},dateFilterValue:B,dateFilterName:"",groupFilterData:{icon:(0,f.jsx)(o.FilterIcon,{height:"14px",width:"14px"}),label:(0,p.Jb)({key:"group",defaultTranslatedValue:u.p.LeaderBoard.group_filter_label}),pickerOptions:(()=>{let e=[];return x.forEach((l=>{e.push({label:l.name,value:l.id,id:l.id,slug:l.slug})})),e})()},groupFilterFooterButtons:q,isSkillFilterOpen:m,handleSkillFilterDropdownOpen:P,handleSkillFilterOptionSelect:O,handleSkillFilterInputChange:I,handleSkillFilterCrossClick:V,handleSkillFilterCheckboxChange:N,handleFilterModalCancel:j,handleFilterModalApply:G,handleFilterModalClose:U,onClickFilterModalButton:H,modalHeaderTitle:(0,p.Jb)({key:"allFilters",defaultTranslatedValue:u.p.LeaderBoard.modal_header_title}),skillFilterData:{pickerOptions:a,placeholder:(0,p.Jb)({key:"LeaderBoard_skillNamePlaceholder",defaultTranslatedValue:u.p.LeaderBoard.skill_name_placeholder})},skillFilterInputValue:L,skillFilterSelectedValue:k,noSearchMessageLabel:(0,p.Jb)({key:"LeaderBoard_noSearchMessageLabel",defaultTranslatedValue:u.p.LeaderBoard.no_search_message_label}),leaderBoardGroupLabelText:(0,p.Jb)({key:"groups",defaultTranslatedValue:u.p.LeaderBoard.leader_board_group_label_text}),leaderBoardGroupLabelSearchPlaceHolder:(0,p.Jb)({key:"leaderBoardGroupLabelSearchPlaceholder",defaultTranslatedValue:u.p.LeaderBoard.leader_board_group_label_search_placeholder}),leaderBoardNoResultsLabel:(0,p.Jb)({key:"LeaderBoard_leaderBoardNoResultsLabel",defaultTranslatedValue:u.p.LeaderBoard.leader_board_no_results_label}),leaderBoardSkillLabelText:(0,p.Jb)({key:"leaderBoardSkillLabel",defaultTranslatedValue:u.p.LeaderBoard.leader_board_skill_label_text}),leaderBoardSkillLabelSearchPlaceHolder:(0,p.Jb)({key:"leaderBoardGroupLabelSearchPlaceholder",defaultTranslatedValue:u.p.LeaderBoard.leader_board_skill_label_search_placeholder}),cancelButtonTextLabel:(0,p.Jb)({key:"cancel",defaultTranslatedValue:u.p.LeaderBoard.cancel_button_text_label}),saveButtonTextLabel:(0,p.Jb)({key:"save",defaultTranslatedValue:u.p.LeaderBoard.save_button_text_label}),rootElement:R})};var h=a(5201),k=a(5523),g=a(8411),m=a(4959);const T={offset:0,query:"",expertise_names:[],group_ids:[],from_date:"",to_date:""},B=()=>{var e,l,a,d,_,v,B,S,y,w,x,C;const E=(0,s.s0)(),[R,F]=(0,r.useState)([]),[P,I]=(0,r.useState)(T),[O,V]=(0,r.useState)(!1),A=(0,h.p)(),{userInfo:D,orgInfo:M}=(0,r.useContext)(c.Il),J=(0,r.useCallback)((e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return""}}),[]),N=(0,r.useCallback)((()=>!(R.totalCount<P.offset+i.default.LIMIT)),[R.totalCount,P.offset]),j=(0,r.useCallback)((async e=>{const{searchParams:l,reset:a}=e||{};try{const e=(null===l||void 0===l?void 0:l.offset)||0,o=l||T;V(!0);const d=await(async e=>{const l=new URL(i.default.LXP_RESOURCES.LEADERBOARD,window.location.origin);if(e)for(const r in e)(!r.includes([i.default.LEADERBOARD_FILTER_KEYS.expertise_names,i.default.LEADERBOARD_FILTER_KEYS.group_ids,i.default.LEADERBOARD_FILTER_KEYS.from_date,i.default.LEADERBOARD_FILTER_KEYS.to_date])||""!==e[r]&&"string"===typeof e[r]||Array.isArray(e[r]))&&(Array.isArray(e[r])&&e[r].length>0?e[r].forEach((e=>{l.searchParams.append("".concat(r,"[]"),e)})):""!==e[r]&&l.searchParams.append(r,e[r]));const a=l.pathname+l.search.replace(/\+/g,"%20");return await(0,b.x)({url:a,requestType:i.default.HTTP_METHOD.GET})})({show_my_result:!0,order_attr:i.default.SMARTBITES_SCORE,limit:i.default.LIMIT,offset:e,q:(null===o||void 0===o?void 0:o.query)||"",...null!==o&&void 0!==o&&o.expertise_names?{expertise_names:null===o||void 0===o?void 0:o.expertise_names}:{},group_ids:null===o||void 0===o?void 0:o.group_ids,from_date:J(null===o||void 0===o?void 0:o.from_date),to_date:J(null===o||void 0===o?void 0:o.to_date),...null!==o&&void 0!==o&&o.from_date||null!==o&&void 0!==o&&o.to_date?{}:{period:i.default.LEADERBOARD_FILTER_KEYS.all_time},version:"v3",fields:i.default.LEADERBOARD_FIELDS}),[t,s]=d;if(a)F((()=>({...t,users:t.users})));else if(t)F((e=>({...e,...t,users:[...(null===e||void 0===e?void 0:e.users)||[],...t.users]})));else{var r;A.open((null===s||void 0===s||null===(r=s.data)||void 0===r?void 0:r.message)||"Something went wrong fetching leaderboard data"),F((e=>({...e,users:[]})))}V(!1)}catch(o){throw V(!1),o}}),[J,A]),U=(0,r.useCallback)((function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";E(l?"".concat(i.default.PAGES.USER_PROFILE,"/").concat(e,"/").concat(l):"".concat(i.default.PAGES.USER_PROFILE,"/").concat(e))}),[E]),G=(0,r.useCallback)((e=>{F((l=>{var a;const r=null===l||void 0===l||null===(a=l.users)||void 0===a?void 0:a.map((l=>{var a,r,o,d,t;return(null===l||void 0===l||null===(a=l.user)||void 0===a?void 0:a.id)===e?{...l,user:{...null===l||void 0===l?void 0:l.user,following:!(null!==l&&void 0!==l&&null!==(r=l.user)&&void 0!==r&&r.following),followersCount:null!==l&&void 0!==l&&null!==(o=l.user)&&void 0!==o&&o.following?(null===l||void 0===l||null===(d=l.user)||void 0===d?void 0:d.followersCount)-1:(null===l||void 0===l||null===(t=l.user)||void 0===t?void 0:t.followersCount)+1}}:l}));return{...l,users:r}}))}),[]),H=(0,r.useCallback)((async e=>{const[,l]=await(0,k.BZ)({user:e.user});var a;l||G(null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.id)}),[G]),q=(0,r.useCallback)((()=>{var e;if(null!==R&&void 0!==R&&null!==(e=R.users)&&void 0!==e&&e.length){var l;const e=null===R||void 0===R||null===(l=R.users)||void 0===l?void 0:l.filter((()=>!0));return null===e||void 0===e||e.sort(((e,l)=>l.smartbitesScore-e.smartbitesScore)),null===e||void 0===e?void 0:e.map(((e,l)=>{var a,r,d,t,s,n,c,b;const _=Object.assign(e),v=(null===_||void 0===_||null===(a=_.user)||void 0===a?void 0:a.expertTopics)||[];(null===_||void 0===_||null===(r=_.user)||void 0===r?void 0:r.isFollowing)&&(_.user.isFollowing=null===_||void 0===_||null===(d=_.user)||void 0===d?void 0:d.following);const L=(null===R||void 0===R||null===(t=R.currentUser)||void 0===t||null===(s=t.user)||void 0===s?void 0:s.id)===(null===_||void 0===_||null===(n=_.user)||void 0===n?void 0:n.id);return(0,f.jsx)("div",{className:L?"edc-leaderboard-row-sticky":"",children:(0,f.jsx)(o.LeaderboardTableRow,{className:"edc-lb-table-content-row",followersCount:_.user.followersCount,isCurrentUser:L,isAdmin:_.user.roles.includes(i.default.ROLE_ADMIN),isMember:_.user.roles.includes(i.default.ROLE_MEMBER),isfollowing:null===_||void 0===_||null===(c=_.user)||void 0===c?void 0:c.following,points:_.smartbitesScore,position:l+1,showBadge:l<3,skills:(null===v||void 0===v||null===(b=v.filter((e=>null===e||void 0===e?void 0:e.topic_label)))||void 0===b?void 0:b.map((e=>null===e||void 0===e?void 0:e.topic_label)))||[],userDetails:{avatar:(0,m.HK)(_.user),fullName:_.user.name,jobTitle:_.user.jobTitle},onFollow:()=>H(_),onUnfollow:()=>H(_),onAvatarClick:()=>U(_.user.id),currentUserLabelText:(0,p.Jb)({key:"you",defaultTranslatedValue:u.p.LeaderBoard.current_user_label_text}),pointPluralLabel:(0,p.Jb)({key:"points",defaultTranslatedValue:u.p.LeaderBoard.point_plural_label}),pointSingularlLabel:(0,p.Jb)({key:"LeaderBoard_pointSingularLabel",defaultTranslatedValue:u.p.LeaderBoard.point_singular_label}),followPluralLabel:(0,p.Jb)({key:"followers",defaultTranslatedValue:u.p.LeaderBoard.follow_plural_label}),followSingularlLabel:(0,p.Jb)({key:"follower",defaultTranslatedValue:u.p.LeaderBoard.follow_singular_label}),followLabelText:(0,p.Jb)({key:"follow",defaultTranslatedValue:u.p.LeaderBoard.follow_label_text}),unFollowLabelText:(0,p.Jb)({key:"unFollow",defaultTranslatedValue:u.p.LeaderBoard.unfollow_label_text}),followingLabelText:(0,p.Jb)({key:"following",defaultTranslatedValue:u.p.LeaderBoard.following_label_text})},_.user.id)},_.user.id)}))}}),[H,U,null===R||void 0===R||null===(e=R.currentUser)||void 0===e||null===(l=e.user)||void 0===l?void 0:l.id,null===R||void 0===R?void 0:R.users]),K=(0,r.useCallback)((()=>{var e,l;return((null===R||void 0===R||null===(e=R.users)||void 0===e?void 0:e.length)>0?R.users[0].smartbitesScore:0)-(null===R||void 0===R||null===(l=R.currentUser)||void 0===l?void 0:l.smartbitesScore)}),[null===R||void 0===R||null===(a=R.currentUser)||void 0===a?void 0:a.smartbitesScore,R.users]),Y=t()((e=>{F([]);const l={...P,query:e,offset:0};I(l),j({searchParams:l,reset:!0})}),500),X=(0,r.useCallback)((e=>{const l={...P,...e,offset:0};I(l),j({searchParams:l,reset:!0})}),[j,P]),Z=(0,r.useMemo)((()=>N()&&!O),[N,O]),Q=(0,r.useCallback)((()=>{if(N()&&!O){const e=P.offset+i.default.LIMIT,l={...P,offset:e};I(l),j({searchParams:l,reset:!1})}}),[N,j,O,P]);(0,r.useEffect)((()=>{j()}),[j]);const z=(0,r.useMemo)((()=>q()),[q]),W=(0,r.useMemo)((()=>(null===D||void 0===D?void 0:D.permissions)&&D.permissions.indexOf(i.default.CARD_CONFIG.USER_PERMISSIONS.GET_LEADERBOARD_INFORMATION)>=0),[D.permissions]),$=(0,r.useMemo)((()=>(0,g.c3)(M)),[M]);(0,r.useMemo)((()=>!1),[null===$||void 0===$||null===(d=$.web)||void 0===d?void 0:d.profile]);return(0,f.jsxs)("div",{className:"edc-learboard-container",children:[(0,f.jsx)("div",{children:(0,f.jsx)(n.Z,{})}),(0,f.jsxs)("div",{className:"edc-leaderboard-header-wrapper",children:[W?(0,f.jsx)("div",{className:"edc-leaderboard-filter",children:(0,f.jsx)(L,{style:{height:"100%",width:"100%"},handleSetSearchParams:X,searchParams:P})}):null,(0,f.jsx)("div",{className:"edc-leaderboard-filter-search",children:(0,f.jsx)(o.Search,{value:P.searchQuery,onSearch:()=>{},onSearchInputChange:Y,placeholder:(0,p.Jb)({key:"leaderBoardGroupLabelSearchPlaceholder",defaultTranslatedValue:u.p.LeaderBoard.search_placeholder}),style:{background:"white"}})})]}),(0,f.jsx)(o.LeaderboardHeaderCard,{leaderboardData:{points:null===R||void 0===R||null===(_=R.currentUser)||void 0===_?void 0:_.smartbitesScore,pointsAway:K(),position:null===R||void 0===R||null===(v=R.currentUser)||void 0===v||null===(B=v.user)||void 0===B?void 0:B.orderByScore},userDetails:{avatar:(0,m.HK)(null===R||void 0===R||null===(S=R.currentUser)||void 0===S?void 0:S.user),fullName:null===R||void 0===R||null===(y=R.currentUser)||void 0===y||null===(w=y.user)||void 0===w?void 0:w.name,jobTitle:null===R||void 0===R||null===(x=R.currentUser)||void 0===x||null===(C=x.user)||void 0===C?void 0:C.jobTitle},learningPlanBtnCallback:()=>{var e,l;return U(null===R||void 0===R||null===(e=R.currentUser)||void 0===e||null===(l=e.user)||void 0===l?void 0:l.id,i.default.PROFILE_TOP_NAV.LEARNING_QUEUE)},loading:!(null!==R&&void 0!==R&&R.users)&&O,myLearningPlanButtonLabel:(0,p.Jb)({key:"LeaderBoard_myLearningPlanButtonLabel",defaultTranslatedValue:u.p.LeaderBoard.my_learning_plan_button_label}),learningPlanInfoMessage:(0,p.Jb)({key:"LeaderBoard_learningPlanInfoMessage",defaultTranslatedValue:u.p.LeaderBoard.learning_plan_info_message}),leaderBoardPositionHeaderTitle:(0,p.Jb)({key:"LeaderBoard_leaderboardPositionHeaderTitle",defaultTranslatedValue:u.p.LeaderBoard.leaderboard_position_header_title}),leaderboardAwayPointMessage:(0,p.Jb)({key:"LeaderBoard_leaderboardAwayPointMessage",defaultTranslatedValue:u.p.LeaderBoard.leaderboard_away_point_message}),learboardTopPointMessage:(0,p.Jb)({key:"LeaderBoard_leaderboardTopPointMessage",defaultTranslatedValue:u.p.LeaderBoard.leaderboard_top_point_message}),pointPluralLabel:(0,p.Jb)({key:"points",defaultTranslatedValue:u.p.LeaderBoard.point_plural_label}),pointSingularlLabel:(0,p.Jb)({key:"LeaderBoard_pointSingularLabel",defaultTranslatedValue:u.p.LeaderBoard.point_singular_label})}),(0,f.jsx)(o.LeaderboardTable,{leaderboardTableRowData:z,isLoading:O,leaderBoardUserLabel:(0,p.Jb)({key:"user",defaultTranslatedValue:u.p.LeaderBoard.leader_board_user_label}),leaderBoardSkillLabel:(0,p.Jb)({key:"leaderBoardSkillLabel",defaultTranslatedValue:u.p.LeaderBoard.leader_board_skill_label}),leaderBoardScoreLabel:(0,p.Jb)({key:"LeaderBoard_leaderBoardScoreLabel",defaultTranslatedValue:u.p.LeaderBoard.leader_board_score_label}),leaderBoardNoFilterTextLabel:(0,p.Jb)({key:"LeaderBoard_leaderBoardNoFilterTextLabel",defaultTranslatedValue:u.p.LeaderBoard.leader_board_no_filter_text_label}),onLoadMore:Q,loadMoreText:(0,p.eO)({key:"viewMore",defaultTranslatedValue:u.p.Cards.view_more}),showLoadMoreButton:Z})]})}}}]);