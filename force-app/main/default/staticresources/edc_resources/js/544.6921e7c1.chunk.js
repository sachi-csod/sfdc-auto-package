"use strict";(self.webpackChunkedc_widgets_sfdc=self.webpackChunkedc_widgets_sfdc||[]).push([[544],{9467:(e,t,l)=>{l.d(t,{Z:()=>s});l(1649);var a=l(2143),n=l(3442),o=l(5490),d=l(7064),i=l(8170);const s=e=>{let{goBack:t}=e;const l=(0,n.s0)();return(0,i.jsx)("div",{className:"edc-position-relative edc-back-button",children:(0,i.jsxs)("div",{onClick:()=>{"function"!==typeof t?l(-1):t()},className:"edc-d-flex edc-pointer edc-align-items-center edc-gap-one-fourth edc-back-button-icon-and-text",children:[(0,i.jsx)("span",{className:"edc-d-inline-flex",children:(0,i.jsx)(a.ArrowBackwardIcon,{width:10,height:20})}),(0,i.jsx)("span",{children:(0,d.TB)({key:"back",defaultTranslatedValue:o.p.Search.back})})]})})}},2098:(e,t,l)=>{l.d(t,{Z:()=>O});var a=l(1649),n=l(2143),o=l(5422),d=l.n(o),i=l(3442),s=l(2856),r=l(5490),u=l(1839),m=l(8984),c=l(5201),v=l(7546),T=l(4019),_=l(744),p=l(5338),A=l(4959),S=l(7064),C=l(8079),y=l(8176),g=l(8170);const f=e=>{var t;let{id:l,setCommentCount:o}=e;const{userInfo:f,rootElement:O}=(0,a.useContext)(m.Il),E=(0,i.s0)(),k=(0,c.p)(),[M,D]=(0,a.useState)(""),[I,h]=(0,a.useState)(""),[b,R]=(0,a.useState)(!1),[P,N]=(0,a.useState)(!1),[x]=(0,a.useState)({offset:0,limit:s.default.LIMIT_10}),[G,H]=(0,a.useState)(!1),[V,L]=(0,a.useState)(""),[Y,w]=(0,a.useState)([]),[U,K]=(0,a.useState)(!1),[j,B]=(0,a.useState)(!1),W=(0,a.useCallback)((e=>{D(e)}),[]),J=(0,a.useMemo)((()=>(0,p.fH)({id:l,offset:x.offset,limit:x.limit})),[x.limit,x.offset,l]),{data:F,isLoading:Z,setData:q}=(0,v.Z)((()=>(0,_.x)({url:J}))),[Q,X]=(0,a.useState)((null===F||void 0===F?void 0:F.comments)||[]),z=(0,a.useCallback)((async e=>{let{offset:t,limit:a}=e;const n=(0,p.fH)({id:l,offset:t,limit:a}),[o,d]=await(0,_.x)({url:n});var i,s;return d?(k.open(null!==(i=null===d||void 0===d||null===(s=d.data)||void 0===s?void 0:s.message)&&void 0!==i?i:(0,S.eO)({key:"errorMessage",defaultTranslatedValue:r.p.Cards.error_message})),[null,d]):o?(X((e=>[...e,...(null===o||void 0===o?void 0:o.comments)||[]])),[o,null]):[null,null]}),[l,k]),$=(0,a.useCallback)((async()=>{H(!0),await z({offset:null===Q||void 0===Q?void 0:Q.length,limit:(null===F||void 0===F?void 0:F.total)-(null===Q||void 0===Q?void 0:Q.length)}),H(!1)}),[null===F||void 0===F?void 0:F.total,null===Q||void 0===Q?void 0:Q.length,z]),ee=(0,a.useMemo)((()=>Number((null===F||void 0===F?void 0:F.total)||0)-Number((null===Q||void 0===Q?void 0:Q.length)||0)),[null===F||void 0===F?void 0:F.total,null===Q||void 0===Q?void 0:Q.length]),te=(0,a.useCallback)((async()=>{const[e,t]=await(0,T.qG)({id:l,message:M});t?k.open(t.data.message):(q((t=>({comments:[e,...t.comments],total:t.total+1}))),o(1),D(""))}),[l,M,o,q,k]),le=(0,a.useCallback)((async()=>{M&&te()}),[M,te]),ae=(0,a.useCallback)((e=>{e.keyCode===s.default.ENTER_KEY_CODE&&Boolean(M)&&(e.preventDefault(),te())}),[M,te]),ne=(0,a.useCallback)((async()=>{K(!0);const[e,t]=await(0,_.x)({url:(0,C.kf)({searchText:null===V||void 0===V?void 0:V.replace("@",""),limit:3,offset:0})});var l,a;if(t)return k.open(null!==(l=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)&&void 0!==l?l:(0,S.eO)({key:"errorMessage",defaultTranslatedValue:r.p.Cards.error_message})),[null,t];e&&w(e),K(!1)}),[V,k]),oe=d()((e=>{L(e)}),1e3),de=(0,a.useMemo)((()=>{var e;return(null===Y||void 0===Y||null===(e=Y.users)||void 0===e?void 0:e.map((e=>({name:null===e||void 0===e?void 0:e.name,handle:null===e||void 0===e?void 0:e.handle,avatarImage:(0,A.HK)(e)}))))||[]}),[null===Y||void 0===Y?void 0:Y.users]),ie=(0,a.useCallback)((e=>{E("".concat(s.default.PAGES.USER_PROFILE,"/").concat(e))}),[E]),se=e=>{let{event:t,mentions:l,handle:a}=e;if((null===t||void 0===t?void 0:t.type)==s.default.MOUSEOVER){const e=null===l||void 0===l?void 0:l.find((e=>e.handle===a));B({name:(null===e||void 0===e?void 0:e.fullName)||"",handle:a||"",avatarImage:(0,A.HK)(e),style:{position:"absolute",top:t.pageY-175,left:t.pageX}})}else B(!1)},re=(0,a.useCallback)((async()=>{const[,e]=await(0,T.lS)({cardId:l,commentId:P});var t,a;e?k.open(null!==(t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)&&void 0!==t?t:(0,S.eO)({key:"errorMessage",defaultTranslatedValue:r.p.Cards.error_message})):(q((e=>{var t;return{comments:null===e||void 0===e||null===(t=e.comments)||void 0===t?void 0:t.filter((e=>e.id!==P)),total:e.total-1}})),o(-1),N(null),k.open((0,S.eO)({key:"Key",defaultTranslatedValue:u.w.Cards.deleteCommentToast})))}),[P,l,o,q,k]),ue=(0,a.useCallback)((async(e,t)=>{t!==s.default.COMMENT.DELETE?t!==s.default.COMMENT.REPORT||R(e):N(e)}),[]),me=(0,a.useCallback)(((e,t,l)=>(0,g.jsx)("span",{onClick:()=>ie(e),onMouseOver:l=>se({event:l,mentions:t,handle:e}),onMouseOut:se,className:"edc-tagged-user",children:l})),[ie]),ce=(0,a.useCallback)(((e,t)=>{const l=null===t||void 0===t?void 0:t.map((e=>null===e||void 0===e?void 0:e.handle));if(l.includes(e))return(0,g.jsx)("span",{onClick:()=>ie(e),onMouseOver:l=>se({event:l,mentions:t,handle:e}),onMouseOut:se,className:"edc-tagged-user",children:e.replace("@","")});if((0,C.xb)(t))return e;var a,n;if(-1!==l.indexOf(null===(a=e.toString())||void 0===a||null===(n=a.replace(".",""))||void 0===n?void 0:n.replace(",",""))){return(null===t||void 0===t?void 0:t.map(((l,a)=>{var n,o;return(null===l||void 0===l?void 0:l.handle)===(null===e||void 0===e||null===(n=e.toString())||void 0===n||null===(o=n.replace(".",""))||void 0===o?void 0:o.replace(",",""))?e.endsWith(".")||e.endsWith(",")?me(e,t,null===l||void 0===l?void 0:l.name):(0,g.jsx)("span",{children:null===l||void 0===l?void 0:l.name},a):""}))).filter((e=>void 0!==e))}return e}),[me,ie]),ve=(0,a.useCallback)((()=>{R(null)}),[]);(0,a.useEffect)((()=>{X((null===F||void 0===F?void 0:F.comments)||[])}),[F]),(0,a.useEffect)((()=>{V&&ne()}),[ne,V]);const Te=(0,g.jsx)("div",{className:"edc-delete_comment_content",children:(0,S.Pd)({key:"CommentSection_deleteCommentContent",defaultTranslatedValue:r.p.CommentSection.delete_comment_content})}),_e=(0,a.useMemo)((()=>{const e=null===f||void 0===f?void 0:f.isAdmin;return t=>{const l=[{label:(0,S.Pd)({key:"report",defaultTranslatedValue:r.p.CommentSection.report_comment_label}),type:"item",value:s.default.COMMENT.REPORT}];return(t||e)&&l.push({label:(0,S.Pd)({key:"delete",defaultTranslatedValue:r.p.CommentSection.delete_comment_label}),type:"item",value:s.default.COMMENT.DELETE}),l}}),[null===f||void 0===f?void 0:f.isAdmin]);return!Z&&F?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(n.Comment,{commentCount:null===F||void 0===F?void 0:F.total,commentRowData:null===Q||void 0===Q?void 0:Q.map((e=>{var t,l,a,n;return{commentLikeCount:e.votesCount,commentMenuOptions:_e((null===(t=e.user)||void 0===t?void 0:t.id)===f.id),commentMsg:null===(l=e.message)||void 0===l||null===(a=l.split(" "))||void 0===a?void 0:a.map(((t,l)=>t.includes("@")?(0,g.jsxs)("span",{children:[(0,g.jsx)("span",{children:ce(t,e.mentions)})," "]},l):"".concat(t," "))),commentTimeStamp:e.createdAt,id:e.id,isCommentLiked:e.isUpvoted,isLikeEnabled:!0,userDetails:{avatar:(0,A.HK)(e.user),designation:null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.jobTitle,fullName:e.user.name,onClick:()=>ie(e.user.handle)}}})),currentUserImg:(0,A.HK)(f),currentUserImgAlt:null===f||void 0===f?void 0:f.name,handleCommentLike:async e=>{var t;const l=null===(t=F.comments)||void 0===t?void 0:t.find((t=>t.id===e)),a=null===l||void 0===l?void 0:l.isUpvoted,[,n]=await(0,p.Sq)({actionType:s.default.ICONS.like,methodType:a?s.default.HTTP_METHOD.DELETE:s.default.HTTP_METHOD.POST,userInfo:f,miniCardData:{id:e},isComment:!0});var o,d;n?k.open(null!==(o=null===n||void 0===n||null===(d=n.data)||void 0===d?void 0:d.message)&&void 0!==o?o:(0,S.eO)({key:"errorMessage",defaultTranslatedValue:r.p.Cards.error_message})):q((t=>{var l;return{comments:null===F||void 0===F||null===(l=F.comments)||void 0===l?void 0:l.map((t=>t.id===e?{...t,isUpvoted:!a,votesCount:a?t.votesCount-1:t.votesCount+1}:t)),total:t.total}}))},handleCommentSelectMenu:ue,commentInputValue:M,onChangeInputValue:W,onCommentBtnClick:le,onCommentInputKeyPress:ae,placeholder:(0,S.Pd)({key:"leaveAComment",defaultTranslatedValue:r.p.CommentSection.placeholder}),toggleAccordion:()=>h((e=>!e)),isAccordionOpen:I,onChangeSearchText:e=>{oe(e)},searchText:V,suggestions:de,isSuggestionLoading:U,showLoadMore:ee>0,onLoadMoreClick:$,commentsLoading:G,rootElement:O,loadMoreText:1===ee?(0,S.Pd)({key:"CommentSection_loadMoreTextSingular",defaultTranslatedValue:r.p.CommentSection.load_more_text_singular}):(0,S.Pd)({key:"CommentSection_loadMoreTextSingular",defaultTranslatedValue:null===(t=r.p.CommentSection.load_more_text_plural)||void 0===t?void 0:t.replace("{{remainingComments}}",ee),variables:{remainingComments:ee}}),commentPluralLabelText:(0,S.Pd)({key:"commentPluralLabel",defaultTranslatedValue:r.p.CommentSection.comment_plural_label_text}),commentSingularLabelText:(0,S.Pd)({key:"commentSingularLabel",defaultTranslatedValue:r.p.CommentSection.comment_singular_label_text}),viewMoreLabelText:(0,S.Pd)({key:"viewMore",defaultTranslatedValue:r.p.CommentSection.view_more_label_text}),likedText:(0,S.Pd)({key:"CommentSection_liked",defaultTranslatedValue:r.p.CommentSection.liked}),likeText:(0,S.Pd)({key:"like",defaultTranslatedValue:r.p.CommentSection.like}),timeAgoStrings:{A_MIN_AGO:(0,S.yS)({key:"TimeAgoStrings_A_MIN_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.A_MIN_AGO}),A_HOUR_AGO:(0,S.yS)({key:"TimeAgoStrings_A_HOUR_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.A_HOUR_AGO}),A_DAY_AGO:(0,S.yS)({key:"TimeAgoStrings_A_DAY_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.A_DAY_AGO}),A_MONTH_AGO:(0,S.yS)({key:"TimeAgoStrings_A_MONTH_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.A_MONTH_AGO}),A_YEAR_AGO:(0,S.yS)({key:"TimeAgoStrings_A_YEAR_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.A_YEAR_AGO}),MINS_AGO:(0,S.yS)({key:"TimeAgoStrings_MINS_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.MINS_AGO}),HOURS_AGO:(0,S.yS)({key:"TimeAgoStrings_HOURS_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.HOURS_AGO}),MONTHS_AGO:(0,S.yS)({key:"TimeAgoStrings_MONTHS_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.MONTHS_AGO}),DAYS_AGO:(0,S.yS)({key:"TimeAgoStrings_DAYS_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.DAYS_AGO}),YEARS_AGO:(0,S.yS)({key:"TimeAgoStrings_YEARS_AGO",defaultTranslatedValue:r.p.TimeAgoStrings.YEARS_AGO})}}),j?(0,g.jsx)("div",{className:"edc-paper box-shadow",style:j.style,children:(0,g.jsx)(n.Avatar,{fullName:j.name,designation:j.handle,imgSrc:j.avatarImage})}):null,(0,g.jsx)(y.w,{isModalOpen:b,cardId:b,closeModal:ve,setIsReported:ve,isComment:!0}),(0,g.jsx)(n.Modal,{isModalOpen:P,modalHeaderData:{headerString:(0,S.Pd)({key:"CommentSection_deleteCommentHeader",defaultTranslatedValue:r.p.CommentSection.delete_comment_header}),closeModal:()=>N(null)},modalBodyData:Te,modalFooterData:{cancelButtonText:(0,S.Pd)({key:"cancel",defaultTranslatedValue:r.p.CommentSection.cancel_label}),submitButtonText:(0,S.Pd)({key:"CommentSection_deleteCommentHeader",defaultTranslatedValue:r.p.CommentSection.delete_comment_header}),closeModal:()=>N(null),submitButtonCallback:()=>{re()}}})]}):null},O=a.memo(f)},6442:(e,t,l)=>{l.d(t,{D:()=>s});var a=l(1649),n=l(2143),o=l(5490),d=l(7064),i=l(8170);const s=e=>{let{isModalOpen:t,modalBody:l,closeModal:s,onMarkAsInComplete:r}=e;const u=(0,a.useMemo)((()=>({headerString:(0,d.eO)({key:"Cards_markAsIncompleteText",defaultTranslatedValue:o.p.Cards.mark_as_incomplete_text}),closeModal:s})),[s]),m=(0,a.useMemo)((()=>({cancelButtonText:(0,d.a3)({key:"cancel",defaultTranslatedValue:o.p.Modal.cancel}),submitButtonText:(0,d.eO)({key:"confirm",defaultTranslatedValue:o.p.Cards.confirm}),isCancelButtonDisable:!1,hasSubmitButton:!0,closeModal:s,submitButtonCallback:()=>{r()}})),[s,r]);return(0,i.jsx)(n.Modal,{isModalOpen:t,modalHeaderData:u,modalFooterData:m,modalBodyData:l})}},1178:(e,t,l)=>{l.d(t,{k:()=>i});var a=l(5338),n=l(2414),o=l(2856);const d=e=>{let{card:t,cardType:l,ld:a}=e;const n=(e=>{var t,l,a,n,d;let{card:i,cardType:s,ld:r}=e;const u=(null===i||void 0===i?void 0:i.resource)&&((null===(t=i.resource)||void 0===t?void 0:t.url)||(null===(l=i.resource)||void 0===l?void 0:l.description)||(null===(a=i.resource)||void 0===a?void 0:a.fileUrl))&&(null===(n=i.resource)||void 0===n||null===(d=n.type)||void 0===d?void 0:d.toLowerCase())!==o.default.CARD_SUBTYPE.VIDEO&&((null===i||void 0===i?void 0:i.readableCardType)&&i.readableCardType.toLowerCase()===o.default.CARD_TYPE.ARTICLE||(null===s||void 0===s?void 0:s.toLowerCase())===o.default.CARD_TYPE.ARTICLE);return!(null!==r&&void 0!==r&&r["show-markAsComplete-on-visit"]||!u)})({card:t,cardType:l,ld:a});return!(null!==t&&void 0!==t&&t.markAsCompleteEnableForLink)&&n&&(null===t||void 0===t?void 0:t.completionState)!==o.default.COMPLETED},i=e=>{let{card:t,cardType:l,userInfo:i,ld:s,layout:r}=e;return d({card:t,cardType:l,ld:s})||(e=>{var t;let{card:l,cardType:d,userInfo:i}=e;const s=(0,a._E)({authorId:null===l||void 0===l||null===(t=l.author)||void 0===t?void 0:t.id,userId:(0,a.n5)(i)});return(null===d||void 0===d?void 0:d.toLowerCase())===o.default.CARD_TYPE.PROJECT&&(0,n.hf)(s)})({card:t,cardType:l,userInfo:i})||(e=>{let{card:t,cardType:l}=e,a=!0;return[100,98].includes(null===t||void 0===t?void 0:t.completedPercentage)&&(a=!1),!![o.default.LOWER_CASE_PATHWAY,o.default.CARD_SUBTYPE.PATHWAY,o.default.JOURNEY.toLowerCase()].includes(l)&&a})({card:t,cardType:l})||(e=>{var t;let{card:l,cardType:n,layout:d}=e;return!!d&&[o.default.CARD_TYPE.PATHWAY,o.default.LOWER_CASE_PATHWAY,o.default.CARD_SUBTYPE.PATHWAY,o.default.JOURNEY.toLowerCase()].includes(null===n||void 0===n?void 0:n.toLowerCase())&&(null===l||void 0===l||null===(t=l.completionState)||void 0===t?void 0:t.toUpperCase())===o.default.COMPLETED&&((0,a.cC)(d)||(0,a.oO)(d))})({card:t,cardType:l,layout:r})}},2414:(e,t,l)=>{l.d(t,{hf:()=>d,nE:()=>i});var a=l(5338),n=l(2856);const o=e=>{let{card:t,cardType:l,isCompleted:a}=e,o=(e=>{var t,l,a;let{isVILTCard:o,card:d}=e,i=o&&(null===d||void 0===d||null===(t=d.trainingDetails)||void 0===t||null===(l=t.registrations)||void 0===l?void 0:l.state)!==n.default.APPROVED;const s=!(!o||null===d||void 0===d||null===(a=d.trainingDetails)||void 0===a||!a.endDate)&&new Date(d.trainingDetails.endDate)-new Date<0;return!o||i||s||(i=!0),i})({isVILTCard:l===n.default.CARD_TYPE.VILT,card:t});return o&&a&&(o=!1),o},d=e=>{let t=!1;return e||(t=!0),t},i=e=>{let{card:t,cardType:l,userInfo:i,permissions:s,ld:r}=e;const{completionState:u}=t,m=(null===u||void 0===u?void 0:u.toUpperCase())===n.default.COMPLETED,c=o({card:t,cardType:l,isCompleted:m}),v=(e=>{var t;let{card:l,cardType:o,isCompleted:i,userInfo:s}=e;const r=(0,a._E)({authorId:null===l||void 0===l||null===(t=l.author)||void 0===t?void 0:t.id,userId:(0,a.n5)(s)});let{markFeatureDisabledForSource:u}=l;return o===n.default.CARD_TYPE.PROJECT&&d(r)&&(u=!0),!u||i})({card:t,cardType:l,isCompleted:m,userInfo:i}),T=(e=>{let{isCompleted:t,ld:l}=e;return t||(null===l||void 0===l?void 0:l["show-markAsComplete-on-visit"])})({isCompleted:m,ld:r}),_=(0,a.Vi)({cardType:l}),p=(e=>{let{cardType:t,isCompleted:l}=e;return[n.default.CARD_TYPE.QUIZ].includes(t)&&!l})({cardType:l,isCompleted:m});return(null===s||void 0===s?void 0:s.isMarkAsCompleteEnabled)&&v&&!_&&!p&&T&&!c}},5886:(e,t,l)=>{l.d(t,{eG:()=>o,x:()=>s});var a=l(7064),n=l(5490);const o={ADD_TO_PATHWAY:"add_to_pathway",ADD_TO_JOURNEY:"add_to_journey",POST_TO_CHANNEL:"post_to_channel",ASSIGN_TO_ME:"assign_to_me",ASSIGN:"assign",PROMOTE:"promote",EDIT:"edit",CHANGE_AUTHOR:"change_author",DELETE:"delete",REPORT:"report",CARD_INSIGHTS:"card_insights",DIVIDER:"divider",DISMISS_ASSIGNMENT:"dismiss_assignment"},d={[o.ADD_TO_PATHWAY]:"isAddToPathwayEnabled",[o.ADD_TO_JOURNEY]:"isAddToJourneyEnabled",[o.POST_TO_CHANNEL]:"isPostToChannelEnabled",[o.ASSIGN_TO_ME]:"isAssignToMeEnabled",[o.ASSIGN]:"isAssignEnabled",[o.CHANGE_AUTHOR]:"isChangeAuthorEnabled",[o.PROMOTE]:"isPromoteEnabled",[o.EDIT]:"isEditEnabled",[o.DELETE]:"isDeleteEnabled",[o.REPORT]:"isReportEnabled",[o.CARD_INSIGHTS]:"isCardInsightsEnabled",[o.DISMISS_ASSIGNMENT]:"isDismissAssignmentEnabled"},i=[{key:o.ADD_TO_PATHWAY,label:"Add to Pathway",permissionKey:d[o.ADD_TO_PATHWAY],type:"item",translationKey:"addToPathway"},{key:o.ADD_TO_JOURNEY,label:"Add to Journey",permissionKey:d[o.ADD_TO_JOURNEY],type:"item",translationKey:"ContextMenu_addToJourney"},{key:o.ASSIGN_TO_ME,label:"Assign to Me",permissionKey:d[o.ASSIGN_TO_ME],type:"item",translationKey:"ContextMenu_assignToMe"},{key:o.ASSIGN,label:"Assign",permissionKey:d[o.ASSIGN],type:"item",translationKey:"assign"},{key:o.DIVIDER,type:"divider"},{key:o.REPORT,label:"Report It",permissionKey:d[o.REPORT],type:"item",translationKey:"report"},{key:o.CARD_INSIGHTS,label:"Card Insights",permissionKey:d[o.CARD_INSIGHTS],type:"item",translationKey:"ContextMenu_cardInsights"},{key:o.DISMISS_ASSIGNMENT,label:"Dismiss from Assignments",permissionKey:d[o.DISMISS_ASSIGNMENT],type:"item",translationKey:"ContextMenu_dismissAssignment"}],s=e=>{var t;let{permissions:l={},t:o}=e;return null===(t=i.filter((e=>{let{permissionKey:t,type:a}=e;return"divider"===a||l[t]})))||void 0===t?void 0:t.map((e=>({...e,label:(0,a.uZ)({key:e.translationKey,defaultTranslatedValue:n.p.ContextMenu[e.key]})||e.label})))}}}]);