"use strict";(self.webpackChunkedc_widgets_sfdc=self.webpackChunkedc_widgets_sfdc||[]).push([[367],{367:(e,a,t)=>{t.r(a),t.d(a,{default:()=>f});var l=t(1649),d=t(2143),i=t(4945),n=t(3442),r=t(2856),s=t(5490),c=t(1839),o=t(7541),u=t(5201),v=t(4019),m=t(4959),b=t(7064),g=t(8079),h=t(8170);const f=e=>{let{selectedTab:a,trainingId:t}=e;const f=(0,u.p)(),x=(0,n.s0)(),S=(0,l.useContext)(o.Z),[k,p]=(0,l.useState)(!0),[C,T]=(0,l.useState)(0),[V,w]=(0,l.useState)([]),[E,_]=(0,l.useState)(0),[y,D]=(0,l.useState)(!1),[j,A]=(0,l.useState)([]),[N,L]=(0,l.useState)(!1),M=(0,l.useCallback)((async()=>{p(!0);const[e,l]=await(0,v.AS)({registrationState:a,trainingId:t,limit:r.default.LIMIT_10,offset:C});var d;l&&f.open((null===l||void 0===l||null===(d=l.data)||void 0===d?void 0:d.message)||r.default.ERRORS.MESSAGE);e&&(w(0===C?(null===e||void 0===e?void 0:e.registrations)||[]:a=>{var t;return[...a,...null!==(t=null===e||void 0===e?void 0:e.registrations)&&void 0!==t?t:[]]}),_(null===e||void 0===e?void 0:e.total)),p(!1)}),[C,a,f,t]),I=(0,l.useCallback)((e=>{(0,g.d1)(e)&&V.length>E&&T((e=>e+r.default.LIMIT_10))}),[V.length,E]),R=(0,l.useCallback)((e=>{L(e),A(e?V.map((e=>e.id)):[])}),[V]),W=(0,l.useCallback)(((e,a)=>{A((t=>a?[...t,e]:t.filter((a=>a!==e))))}),[]),P=(0,l.useCallback)((()=>{D(!1)}),[]),B=(0,h.jsx)("div",{className:"edc-live-modal-body",children:(0,b.AW)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabApprovalModalLabel.replace("{{selected}}",j.length),variables:{selected:j.length}})}),O=(0,l.useMemo)((()=>V.map(((e,a)=>[{align:"edc-text-td-left",id:"name-".concat(a,"-1"),label:(0,h.jsxs)("div",{className:"edc-attendees-tb-checkbox",children:[(0,h.jsx)(d.Checkbox,{onChange:a=>W(e.id,a.target.checked),checked:j.includes(e.id)}),(0,h.jsx)(d.Avatar,{imgSrc:(0,m.HK)(null===e||void 0===e?void 0:e.registerUser),fullName:e.registerUser.fullName,onClick:()=>{var a;x("".concat(r.default.PAGES.USER_PROFILE,"/").concat(null===e||void 0===e||null===(a=e.registerUser)||void 0===a?void 0:a.id))}})]})},{align:"edc-text-td-left edc-text-truncate-1",id:"handle-".concat(a,"-2"),label:(0,h.jsx)("div",{onClick:()=>{var a;x("".concat(r.default.PAGES.USER_PROFILE,"/").concat(null===e||void 0===e||null===(a=e.registerUser)||void 0===a?void 0:a.id))},children:e.registerUser.handle})},{align:"edc-text-td-left",id:"registered-".concat(a,"-4"),label:S(e.registrationDate).format("l")},{align:"edc-text-td-left",id:"time-".concat(a,"-5"),label:S(e.registrationTime,"HH:mm:ss").format("h:mm A")},{align:"edc-text-td-left edc-text-truncate-1",id:"status-".concat(a,"-6"),label:(0,g.fm)(null===e||void 0===e?void 0:e.state)}]))),[V,W,S,x,j]),U=(0,l.useMemo)((()=>[{label:(0,h.jsx)("div",{className:"edc-attendees-th-checkbox",children:(0,h.jsx)(d.Checkbox,{label:(0,b.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabNameLabel}),labelClassName:"edc-text-truncate-1",onChange:e=>R(e.target.checked),checked:N})}),align:"text-left",id:1},{label:(0,b.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabHandleLabel}),align:"edc-th-text-left",id:2},{label:(0,b.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabRegisteredOnLabel}),align:"edc-th-text-left",id:3},{label:(0,b.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabTimeLabel}),align:"edc-th-text-left",id:4},{label:(0,b.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabStatusLabel}),align:"edc-th-text-left",id:5}]),[R,N]),K=(0,l.useCallback)((async e=>{let{trainingId:a}=e;const[,t]=await(0,v.uX)({trainingId:a,payload:{current_state:r.default.LIVE_ATTENDEES_TABS.REJECTED,new_state:r.default.LIVE_ATTENDEES_TABS.APPROVED,training_registration_ids:j}});var l,d;t?f.open(null!==(l=null===t||void 0===t||null===(d=t.data)||void 0===d?void 0:d.message)&&void 0!==l?l:(0,b.a3)({key:"errorMessage",defaultTranslatedValue:s.p.Modal.error_message})):(M(),A([]),L(!1));D(!1)}),[M,j,f]);return(0,l.useEffect)((()=>{0===j.length&&L(!1)}),[j.length]),(0,l.useEffect)((()=>{M()}),[M]),(0,h.jsxs)("div",{className:"edc-live-card-attendees-view-container",children:[k?(0,h.jsx)(d.Spinner,{}):V.length?(0,h.jsxs)("div",{className:"edc-live-attendees-container",children:[(0,h.jsxs)("div",{className:"edc-live-card-title-header",children:[(0,h.jsx)("span",{children:"".concat((0,b.mr)({key:"members",defaultTranslatedValue:s.p.ManagerDashboard.members})," ").concat(V.length>0?V.length:"")}),(0,h.jsx)(d.PrimaryButton,{text:(0,b.AW)({key:"SmartCardDetailView_approveLabel",defaultTranslatedValue:s.p.SmartCardDetailView.approve_label}),variant:j.length?"contained":"outlined",onClick:()=>{D(!0)},disabled:!j.length})]}),(0,h.jsx)("div",{className:"edc-table-container",onScroll:e=>{I(e)},children:(0,h.jsx)(d.Table,{theadData:U,tbodyData:O,customClass:"edc-table"})}),(0,h.jsx)("div",{className:"edc-registration-table-footer",children:(0,b.hC)({key:"ShareModal_selectedCountText",defaultTranslatedValue:s.p.ShareModal.selected_count_text.replace("{{selected}}",0).replace("{{total}}",V.length||j.length),variables:{selected:j.length,total:V.length||0}})})]}):(0,h.jsx)("div",{className:"edc-d-flex edc-align-items-center  edc-justify-content-center",children:(0,h.jsxs)("div",{className:"edc-no-result-calender",children:[(0,h.jsx)("div",{className:"edc-no-result-calender-svg",children:(0,h.jsx)(d.CalendarIcon,{width:50,height:50,color:"var(--edc-color-green_primary)"})}),(0,h.jsx)("div",{className:"edc-no-result-label",children:(0,b.eO)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveNoDataLabel})})]})}),i.createPortal((0,h.jsx)("div",{children:y?(0,h.jsx)(d.Modal,{isModalOpen:y,modalHeaderData:{headerString:(0,b.AW)({key:"SmartCardDetailView_approveLabel",defaultTranslatedValue:s.p.SmartCardDetailView.approve_label}),closeModal:P},modalBodyData:B,modalFooterData:{cancelButtonText:(0,b.a3)({key:"cancel",defaultTranslatedValue:s.p.Modal.cancel}),submitButtonText:(0,b.AW)({key:"SmartCardDetailView_approveLabel",defaultTranslatedValue:s.p.SmartCardDetailView.approve_label}),closeModal:P,submitButtonCallback:()=>{K({trainingId:t})}}}):null}),document.body)]})}}}]);