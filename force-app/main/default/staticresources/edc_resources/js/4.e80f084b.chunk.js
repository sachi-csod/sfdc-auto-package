"use strict";(self.webpackChunkedc_widgets_sfdc=self.webpackChunkedc_widgets_sfdc||[]).push([[4],{4004:(e,a,l)=>{l.r(a),l.d(a,{default:()=>f});var t=l(1649),d=l(2143),i=l(4945),n=l(3442),s=l(2856),r=l(5490),c=l(1839),o=l(7541),u=l(5201),v=l(4019),m=l(4959),g=l(7064),b=l(8079),h=l(8170);const f=e=>{var a,l,f,k;let{selectedTab:x,trainingId:T,cardData:S}=e;const y=(0,u.p)(),C=(0,n.s0)(),D=(0,t.useContext)(o.Z),[V,w]=(0,t.useState)(!0),[E,p]=(0,t.useState)(0),[M,_]=(0,t.useState)([]),[j,A]=(0,t.useState)(0),[N,L]=(0,t.useState)(!1),[O,I]=(0,t.useState)(!1),[B,P]=(0,t.useState)([]),[R,K]=(0,t.useState)(!1),U=(0,t.useCallback)((async()=>{w(!0);const[e,a]=await(0,v.AS)({registrationState:x,trainingId:T,limit:s.default.LIMIT_10,offset:E});var l;a&&y.open((null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)||s.default.ERRORS.MESSAGE);e&&(_(0===E?(null===e||void 0===e?void 0:e.registrations)||[]:a=>{var l;return[...a,...null!==(l=null===e||void 0===e?void 0:e.registrations)&&void 0!==l?l:[]]}),A(null===e||void 0===e?void 0:e.total)),w(!1)}),[E,x,y,T]),W=(0,t.useCallback)((e=>{(0,b.d1)(e)&&M.length>j&&p((e=>e+s.default.LIMIT_10))}),[M.length,j]),H=(0,t.useCallback)((e=>{K(e),P(e?M.map((e=>e.id)):[])}),[M]),Y=(0,t.useCallback)(((e,a)=>{P((l=>a?[...l,e]:l.filter((a=>a!==e))))}),[]),F=(0,t.useCallback)((()=>{L(!1)}),[]),G=(0,t.useCallback)((()=>{I(!1)}),[]),X=(0,h.jsx)("div",{className:"edc-live-modal-body",children:(0,g.AW)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabMarkAsCompleteModalLabel.replace("{{selected}}",B.length),variables:{selected:B.length}})}),J=(0,h.jsx)("div",{className:"edc-live-modal-body",children:(0,g.AW)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabDeclineModalLabel.replace("{{selected}}",B.length),variables:{selected:B.length}})}),Z=(0,t.useMemo)((()=>M.map(((e,a)=>[{align:"edc-text-td-left",id:"name-".concat(a,"-1"),label:(0,h.jsxs)("div",{className:"edc-attendees-tb-checkbox",children:[(0,h.jsx)(d.Checkbox,{onChange:a=>Y(e.id,a.target.checked),checked:B.includes(e.id)}),(0,h.jsx)(d.Avatar,{imgSrc:(0,m.HK)(null===e||void 0===e?void 0:e.registerUser),fullName:e.registerUser.fullName,onClick:()=>{var a;C("".concat(s.default.PAGES.USER_PROFILE,"/").concat(null===e||void 0===e||null===(a=e.registerUser)||void 0===a?void 0:a.id))}})]})},{align:"edc-text-td-left edc-text-truncate-1",id:"handle-".concat(a,"-2"),label:(0,h.jsx)("div",{onClick:()=>{var a;C("".concat(s.default.PAGES.USER_PROFILE,"/").concat(null===e||void 0===e||null===(a=e.registerUser)||void 0===a?void 0:a.id))},children:e.registerUser.handle})},{align:"edc-text-td-left",id:"registered-".concat(a,"-4"),label:D(e.registrationDate).format("l")},{align:"edc-text-td-left",id:"time-".concat(a,"-5"),label:D(e.registrationTime,"HH:mm:ss").format("h:mm A")},{align:"edc-text-td-left edc-text-truncate-1",id:"status-".concat(a,"-6"),label:(0,b.fm)(null===e||void 0===e?void 0:e.state)}]))),[M,Y,D,C,B]),q=(0,t.useMemo)((()=>[{label:(0,h.jsx)("div",{className:"edc-attendees-th-checkbox",children:(0,h.jsx)(d.Checkbox,{label:(0,g.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabNameLabel}),labelClassName:"edc-text-truncate-1",onChange:e=>H(e.target.checked),checked:R})}),align:"text-left",id:1},{label:(0,g.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabHandleLabel}),align:"edc-th-text-left",id:2},{label:(0,g.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabRegisteredOnLabel}),align:"edc-th-text-left",id:3},{label:(0,g.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabTimeLabel}),align:"edc-th-text-left",id:4},{label:(0,g.AW)({key:"KEY",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabStatusLabel}),align:"edc-th-text-left",id:5}]),[H,R]),z=(0,t.useCallback)((async e=>{let{trainingId:a}=e;const[,l]=await(0,v.uX)({trainingId:a,payload:{current_state:s.default.LIVE_ATTENDEES_TABS.APPROVED,new_state:s.default.MARK_AS_COMPLETE,training_registration_ids:B}});var t,d;l?y.open(null!==(t=null===l||void 0===l||null===(d=l.data)||void 0===d?void 0:d.message)&&void 0!==t?t:(0,g.a3)({key:"errorMessage",defaultTranslatedValue:r.p.Modal.error_message})):(y.open((0,g.eO)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveToastMarkAsComplete})),U(),K(!1),P([]));L(!1)}),[U,B,y]),Q=(0,t.useCallback)((async e=>{let{trainingId:a}=e;const[,l]=await(0,v.uX)({trainingId:a,payload:{current_state:s.default.LIVE_ATTENDEES_TABS.APPROVED,new_state:s.default.LIVE_ATTENDEES_TABS.REJECTED,training_registration_ids:B}});var t,d;l?y.open(null!==(t=null===l||void 0===l||null===(d=l.data)||void 0===d?void 0:d.message)&&void 0!==t?t:(0,g.a3)({key:"errorMessage",defaultTranslatedValue:r.p.Modal.error_message})):(U(),K(!1),P([]));I(!1)}),[U,B,y]);return(0,t.useEffect)((()=>{0===B.length&&K(!1)}),[B.length]),(0,t.useEffect)((()=>{U()}),[U]),(0,h.jsxs)("div",{className:"edc-live-card-attendees-view-container",children:[V?(0,h.jsx)(d.Spinner,{}):M.length?(0,h.jsxs)("div",{className:"edc-live-attendees-container",children:[(0,h.jsxs)("div",{className:"edc-live-card-title-header",children:[(0,h.jsx)("span",{children:"".concat((0,g.mr)({key:"members",defaultTranslatedValue:r.p.ManagerDashboard.members})," ").concat(M.length>0?M.length:"")}),(0,h.jsxs)("div",{className:"edc-live-combined-button",children:[(0,h.jsx)(d.PrimaryButton,{text:(0,g.eO)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabMarkAsCompleteLabel}),variant:!B.length||D().isSameOrBefore(null===S||void 0===S||null===(a=S.trainingDetails)||void 0===a?void 0:a.endDate)?"outlined":"contained",onClick:()=>{L(!0)},disabled:!B.length||D().isSameOrBefore(null===S||void 0===S||null===(l=S.trainingDetails)||void 0===l?void 0:l.endDate)}),(0,h.jsx)(d.PrimaryButton,{text:(0,g.eO)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabDeclineLabel}),variant:B.length&&D().isSameOrBefore(null===S||void 0===S||null===(f=S.trainingDetails)||void 0===f?void 0:f.endDate)?"contained":"outlined",onClick:()=>{I(!0)},disabled:!B.length||!D().isSameOrBefore(null===S||void 0===S||null===(k=S.trainingDetails)||void 0===k?void 0:k.endDate)})]})]}),(0,h.jsx)("div",{className:"edc-table-container",onScroll:e=>{W(e)},children:(0,h.jsx)(d.Table,{theadData:q,tbodyData:Z,customClass:"edc-table"})}),(0,h.jsx)("div",{className:"edc-registration-table-footer",children:(0,g.hC)({key:"ShareModal_selectedCountText",defaultTranslatedValue:r.p.ShareModal.selected_count_text.replace("{{selected}}",0).replace("{{total}}",M.length||B.length),variables:{selected:B.length,total:M.length||0}})})]}):(0,h.jsx)("div",{className:"edc-d-flex edc-align-items-center  edc-justify-content-center",children:(0,h.jsxs)("div",{className:"edc-no-result-calender",children:[(0,h.jsx)("div",{className:"edc-no-result-calender-svg",children:(0,h.jsx)(d.CalendarIcon,{width:50,height:50,color:"var(--edc-color-green_primary)"})}),(0,h.jsx)("div",{className:"edc-no-result-label",children:(0,g.eO)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveNoDataLabel})})]})}),i.createPortal((0,h.jsx)("div",{children:N?(0,h.jsx)(d.Modal,{isModalOpen:N,modalHeaderData:{headerString:(0,g.eO)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabMarkAsCompleteLabel}),closeModal:F},modalBodyData:X,modalFooterData:{cancelButtonText:(0,g.a3)({key:"cancel",defaultTranslatedValue:r.p.Modal.cancel}),submitButtonText:(0,g.a3)({key:"confirm",defaultTranslatedValue:r.p.Modal.confirm}),closeModal:F,submitButtonCallback:()=>{z({trainingId:T})}}}):null}),document.body),i.createPortal((0,h.jsx)("div",{children:O?(0,h.jsx)(d.Modal,{isModalOpen:O,modalHeaderData:{headerString:(0,g.eO)({key:"key",defaultTranslatedValue:c.w.SmartCardDetailView.liveTabDeclineLabel}),closeModal:G},modalBodyData:J,modalFooterData:{cancelButtonText:(0,g.a3)({key:"cancel",defaultTranslatedValue:r.p.Modal.cancel}),submitButtonText:(0,g.a3)({key:"confirm",defaultTranslatedValue:r.p.Modal.confirm}),closeModal:G,submitButtonCallback:()=>{Q({trainingId:T})}}}):null}),document.body)]})}}}]);