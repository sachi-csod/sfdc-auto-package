"use strict";(self.webpackChunkedc_widgets_sfdc=self.webpackChunkedc_widgets_sfdc||[]).push([[777],{7777:(e,a,l)=>{l.r(a),l.d(a,{default:()=>P});var i=l(1649),d=l(2143),t=l(3442),o=l(4945),n=l(2272),r=l(2856),s=l(5490),u=l(8984),v=l(5201),c=l(4019),m=l(5338),p=l(8411),C=l(4959),T=l(7064),k=l(8079),S=l(8170);const b=l(8081),f=e=>{var a,l,f,_,D,y,g,V,w,A,E,x,h,M,L,I;let{cardData:O="",cardMetricsData:P={},cardMetaData:R={},setHideMarkAsComplete:j}=e;const W=(0,t.s0)(),B=(0,v.p)(),[U,N]=(0,i.useState)(null),{userInfo:F,orgInfo:H,ldFlags:G}=(0,i.useContext)(u.Il),[z,Y]=(0,i.useState)(),[q,Q]=(0,i.useState)(null===O||void 0===O?void 0:O.projectSubmissionDetails),[Z,K]=(0,i.useState)(O),[J,X]=(0,i.useState)(!1),[$,ee]=(0,i.useState)({}),[ae,le]=(0,i.useState)(!1),[ie,de]=(0,i.useState)({}),[te,oe]=(0,i.useState)(!1),ne=(0,i.useMemo)((()=>(0,m.GJ)(null===F||void 0===F?void 0:F.isAdmin,null===F||void 0===F?void 0:F.permissions)),[null===F||void 0===F?void 0:F.isAdmin,null===F||void 0===F?void 0:F.permissions]),re=(0,p.c3)(H),se=null===re||void 0===re||null===(a=re.web)||void 0===a||null===(l=a.content)||void 0===l||null===(f=l["web/content/disableDownload"])||void 0===f?void 0:f.value,ue=(0,i.useMemo)((()=>{if((0,k.xb)(null===Z||void 0===Z?void 0:Z.filestack))return!1;var e,a;if((null===Z||void 0===Z||null===(e=Z.filestack[0])||void 0===e?void 0:e.url)&&(0,m.VJ)({htmlText:null===Z||void 0===Z?void 0:Z.cardMessage,url:Z.filestack[0].url}))return!1;if(null!==Z&&void 0!==Z&&null!==(a=Z.filestack[0])&&void 0!==a&&a.mimetype.includes("application/pdf"))return!1;return!0}),[null===Z||void 0===Z?void 0:Z.cardMessage,Z.filestack]),ve=(0,i.useMemo)((()=>!((null===Z||void 0===Z?void 0:Z.cardType)!==r.default.CARD_TYPE.MEDIA||(null===Z||void 0===Z?void 0:Z.cardSubtype)!==r.default.CARD_SUBTYPE.IMAGE&&(null===Z||void 0===Z?void 0:Z.cardSubtype)!==r.default.CARD_SUBTYPE.TEXT||ue)),[null===Z||void 0===Z?void 0:Z.cardSubtype,null===Z||void 0===Z?void 0:Z.cardType,ue]),{isAssignedUser:ce,maxSubmissionReattempts:me,isAuthor:pe,isSubmitterTypeAnyone:Ce,submissionAttemptsMade:Te,alreadyPassed:ke,media:Se}=(0,i.useMemo)((()=>{var e,a,l,i,d,t,o,n,s;return{isAssignedUser:(0,m.n5)(F)===(null===O||void 0===O||null===(e=O.assignment)||void 0===e?void 0:e.user_id),isAssigner:(0,m.n5)(F)===(null===O||void 0===O||null===(a=O.assigner)||void 0===a?void 0:a.id),maxSubmissionReattempts:null===O||void 0===O||null===(l=O.projectDetails)||void 0===l?void 0:l.maxReAttemptsAllowed,isAuthor:(0,m.n5)(F)===(null===O||void 0===O||null===(i=O.author)||void 0===i?void 0:i.id),isSubmitterTypeAnyone:(null===O||void 0===O||null===(d=O.projectDetails)||void 0===d?void 0:d.submitterType)===r.default.SUBMIT_TYPE_ANYONE,submissionAttemptsMade:(null===O||void 0===O||null===(t=O.projectSubmissionDetails)||void 0===t?void 0:t.submissionsCount)||0,alreadyPassed:null===O||void 0===O||null===(o=O.projectSubmissionDetails)||void 0===o?void 0:o.isPass,media:null!==O&&void 0!==O&&null!==(n=O.projectDetails)&&void 0!==n&&null!==(s=n.filestack)&&void 0!==s&&s.length?null===O||void 0===O?void 0:O.projectDetails:null}}),[O,F]),be=(0,i.useMemo)((()=>{var e;return!pe&&((Ce||ce)&&!(null!==q&&void 0!==q&&q.id)&&!(null!==$&&void 0!==$&&$.url||null!==$&&void 0!==$&&$.media)||!(null!==q&&void 0!==q&&q.submission||null!==q&&void 0!==q&&q.media||!q&&(null!==$&&void 0!==$&&$.url||null!==$&&void 0!==$&&null!==(e=$.media)&&void 0!==e&&e.length)))}),[pe,Ce,ce,q,null===$||void 0===$?void 0:$.url,null===$||void 0===$?void 0:$.media]),fe=(null===Z||void 0===Z||null===(_=Z.projectSubmissionDetails)||void 0===_?void 0:_.grade)!==r.default.GRADE_IN_REVIEW,_e=(0,i.useMemo)((()=>{var e,a,l,i,d;const t=null===Z||void 0===Z||null===(e=Z.quiz)||void 0===e||null===(a=e.quizQuestions)||void 0===a?void 0:a.length,o=Object.keys(ie),n=null===Z||void 0===Z||null===(l=Z.quiz)||void 0===l?void 0:l.hasAttempted,r=null===Z||void 0===Z||null===(i=Z.quiz)||void 0===i?void 0:i.reanswerable;return!!(null!==Z&&void 0!==Z&&null!==(d=Z.quiz)&&void 0!==d&&d.mandatory&&t>o.length)||!(!n||r)}),[null===Z||void 0===Z?void 0:Z.quiz,ie]);(0,i.useEffect)((()=>{var e,a;(null===Z||void 0===Z?void 0:Z.cardType)!==r.default.CARD_TYPE.PROJECT||null!==Z&&void 0!==Z&&null!==(e=Z.projectSubmissionDetails)&&void 0!==e&&e.id&&(null===Z||void 0===Z||null===(a=Z.projectSubmissionDetails)||void 0===a||!a.id||fe)?(null===Z||void 0===Z?void 0:Z.cardType)===r.default.CARD_TYPE.POLL?j(!0):j(!1):j(!0)}),[fe,null===Z||void 0===Z?void 0:Z.projectSubmissionDetails,null===Z||void 0===Z?void 0:Z.cardType,Z,j]);const De=(0,i.useCallback)((async()=>{const[e,a]=await(0,c.Od)({cardId:null===Z||void 0===Z?void 0:Z.id,methodType:r.default.HTTP_METHOD.GET});var l,i;(a&&B.open((0,T.eO)({key:"Cards_cardError",defaultTranslatedValue:s.p.Cards.card_error})),e)&&(null===e||void 0===e||null===(l=e.quiz)||void 0===l||null===(i=l.quizQuestions)||void 0===i||i.forEach((e=>{var a;null===e||void 0===e||null===(a=e.questionOptions)||void 0===a||a.forEach((e=>{e.isCorrect=!1}))})),K(e))}),[null===Z||void 0===Z?void 0:Z.id,B]),ye=(0,i.useMemo)((()=>(0,m.LW)({card:Z,orgInfo:H,userInfo:F})),[Z,H,F]),ge=(0,i.useCallback)((async e=>{var a;let{selectedQuizAnswer:l}=e;const i={submitted_answer:l,use_mark_as_complete_v2:!0},[d,t]=await(0,c._U)({quizId:null===Z||void 0===Z||null===(a=Z.quiz)||void 0===a?void 0:a.id,payload:i});var o;t&&B.open((null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message)||(0,T.eO)({key:"Cards_cardError",defaultTranslatedValue:s.p.Cards.card_error}));d&&(K(null===d||void 0===d?void 0:d.card),oe(!0))}),[null===Z||void 0===Z||null===(D=Z.quiz)||void 0===D?void 0:D.id,B]),Ve=(0,i.useMemo)((()=>{const e=(null===H||void 0===H?void 0:H.platformDomain)===r.default.CMNETWORK_DOMAIN;return(0,C._h)(F.filestackApp,e)}),[null===H||void 0===H?void 0:H.platformDomain,F.filestackApp]),we=(0,i.useMemo)((()=>{var e;return(null===Z||void 0===Z?void 0:Z.cardType)===r.default.CARD_SUBTYPE.QUIZ&&(null===Z||void 0===Z||null===(e=Z.filestack[0])||void 0===e?void 0:e.mimetype.includes(r.default.MIMIETYPE.MIME_APPLICATION))}),[null===Z||void 0===Z?void 0:Z.cardType,null===Z||void 0===Z?void 0:Z.filestack]),Ae=(0,i.useMemo)((()=>{var e;return(null===Z||void 0===Z?void 0:Z.cardType)===r.default.CARD_SUBTYPE.QUIZ&&(null===Z||void 0===Z||null===(e=Z.filestack[0])||void 0===e?void 0:e.mimetype.includes(r.default.MIMIETYPE.MIME_AUDIO))}),[null===Z||void 0===Z?void 0:Z.cardType,null===Z||void 0===Z?void 0:Z.filestack]),Ee=(0,i.useMemo)((()=>{var e;return(null===Z||void 0===Z?void 0:Z.cardType)===r.default.CARD_SUBTYPE.QUIZ&&(null===Z||void 0===Z||null===(e=Z.filestack[0])||void 0===e?void 0:e.mimetype.includes(r.default.MIMIETYPE.MIME_VIDEO))}),[null===Z||void 0===Z?void 0:Z.cardType,null===Z||void 0===Z?void 0:Z.filestack]),xe=(0,i.useMemo)((()=>{var e,a;return!((null===Z||void 0===Z?void 0:Z.cardSubtype)!==r.default.CARD_SUBTYPE.FILE&&!we&&!ve||null===Z||void 0===Z||null===(e=Z.filestack)||void 0===e||null===(a=e[0])||void 0===a||!a.handle)}),[null===Z||void 0===Z?void 0:Z.cardSubtype,null===Z||void 0===Z?void 0:Z.filestack,ve,we]);(0,i.useEffect)((()=>{if(!te&&xe){var e;const a=null===Z||void 0===Z||null===(e=Z.filestack[0])||void 0===e?void 0:e.handle;Ve.preview(a,{id:"cardSubTypeFileId"})}}),[null===Z||void 0===Z?void 0:Z.filestack,Ve,xe,te]);const he=(0,i.useCallback)((async()=>{var e;const[a,l]=await(0,c.F5)({quizId:null===Z||void 0===Z||null===(e=Z.quiz)||void 0===e?void 0:e.id});if(l&&B.open((0,T.eO)({key:"Cards_cardError",defaultTranslatedValue:s.p.Cards.card_error})),a){var i,d;const e={event:r.default.ANALITICAL_EVENTS.quiz_report_download,measurement:r.default.DISCOVER_TAB.CARDS,attributes:{quiz_id:null===Z||void 0===Z||null===(i=Z.quiz)||void 0===i?void 0:i.id,is_author:(null===Z||void 0===Z||null===(d=Z.author)||void 0===d?void 0:d.id)===(null===F||void 0===F?void 0:F.id)},card_id:null===Z||void 0===Z?void 0:Z.id},[a,l]=await(0,c.ok)({payload:e});l&&B.open((0,T.eO)({key:"Cards_cardError",defaultTranslatedValue:s.p.Cards.card_error})),a&&B.open((0,T.eO)({key:"Cards_successReportSent",defaultTranslatedValue:s.p.Cards.success_report_sent}))}}),[null===Z||void 0===Z||null===(y=Z.author)||void 0===y?void 0:y.id,null===Z||void 0===Z?void 0:Z.id,null===Z||void 0===Z||null===(g=Z.quiz)||void 0===g?void 0:g.id,null===F||void 0===F?void 0:F.id,B]),Me=(0,i.useCallback)((async e=>{X(!0);const a={selections:[null===e||void 0===e?void 0:e.id]},[l,i]=await(0,c.Kp)({payload:a,cardId:null===Z||void 0===Z?void 0:Z.id});i&&B.open((0,T.eO)({key:"Cards_cardError",defaultTranslatedValue:s.p.Cards.card_error})),l&&De(),X(!1)}),[null===Z||void 0===Z?void 0:Z.id,De,B]),Le=(0,i.useCallback)((e=>{var a,l;K({...e,quiz:{...e.quiz,hasAttempted:!1,canBeEdited:!0,passed:null,quizQuestions:null===e||void 0===e||null===(a=e.quiz)||void 0===a||null===(l=a.quizQuestions)||void 0===l?void 0:l.map((e=>({...e,questionAttempts:null,passed:null})))}})}),[]),Ie=(0,i.useCallback)((()=>{Q(Z.projectSubmissionDetails),ee({})}),[Z.projectSubmissionDetails]),Oe=(0,i.useCallback)((e=>{if(U)N(null);else{var a;const l=null===(a=[...document.querySelectorAll("button")])||void 0===a?void 0:a.filter((e=>e.textContent.includes(r.default.ADD_SUBMISSIONS)))[0],i=e.target||l;N(i)}}),[U]),Pe=(0,i.useCallback)((async()=>{const[e,a]=await(0,c.Gq)({cardId:null===Z||void 0===Z?void 0:Z.id,methodType:r.default.HTTP_METHOD.GET});var l;(e&&Y(e),a)&&B.on((null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)||r.default.ERRORS.MESSAGE)}),[null===Z||void 0===Z?void 0:Z.id,B]),Re=(0,i.useCallback)((e=>{N((a=>a?null:e.target))}),[]),je=(0,i.useCallback)((async e=>{const[a,l]=await(0,c.u6)({submissionId:e,methodType:r.default.HTTP_METHOD.DELETE});var i;l?B.open((null===l||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message)||r.default.ERRORS.MESSAGE):a&&(Q(null),ee(null),K((e=>({...e,projectSubmissionDetails:{}}))))}),[B]);(0,i.useEffect)((()=>{Y(P)}),[P]),(0,i.useEffect)((()=>{Q(null===Z||void 0===Z?void 0:Z.projectSubmissionDetails)}),[null===Z||void 0===Z?void 0:Z.projectSubmissionDetails]);const[,We]=(0,i.useState)(!1),[Be,Ue]=(0,i.useState)(),[Ne,Fe]=(0,i.useState)(),He=(0,i.useMemo)((()=>new Intl.DateTimeFormat("en-GB",{day:"2-digit",year:"numeric",month:"short"}).format(new Date)),[]),Ge=(0,i.useCallback)((()=>{const e=He();ee({url:"",date:e,media:[Be]}),N(null),Q(null)}),[He,Be]),ze=(0,i.useCallback)((()=>{Ue(null),Fe(null),N(null)}),[]),Ye=(0,i.useCallback)((e=>{var a;B.open((null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||r.default.ERRORS.MESSAGE)}),[B]);(0,i.useEffect)((()=>{const e=Be;if(e){const a=(0,C.UY)(e,H.serveFsContentViaAwsCdnEnabled,F.jwtToken,F.filestackApp,(null===H||void 0===H?void 0:H.platformDomain)===r.default.CMNETWORK_DOMAIN);Fe({uploadUrl:null===e||void 0===e?void 0:e.url,name:null===e||void 0===e?void 0:e.filename,previewUrl:a})}}),[null===H||void 0===H?void 0:H.platformDomain,null===H||void 0===H?void 0:H.serveFsContentViaAwsCdnEnabled,Be,null===F||void 0===F?void 0:F.filestackApp,null===F||void 0===F?void 0:F.jwtToken]);const qe=(0,i.useCallback)((async()=>{let e=(null===F||void 0===F?void 0:F.filestackApiKey)||"",a={},l={},i=await(0,k.mt)(Ye);i&&(a=null===i||void 0===i?void 0:i.policy,l=null===i||void 0===i?void 0:i.signature);const d={security:{policy:a,signature:l}},t={onUploadDone:e=>{null!==e&&void 0!==e&&e.filesUploaded&&e.filesUploaded[0]&&e.filesUploaded[0].url&&(We(e.filesUploaded[0].url.length>r.default.MAX_URL_LENGTH),e.filesUploaded[0].url.length<r.default.MAX_URL_LENGTH&&Ue(e.filesUploaded[0]))},fromSources:(0,k.gK)(null===H||void 0===H?void 0:H.configs),accept:r.default.SUPPORTED_FILE_TYPE};(await b.init(e,d)).picker(t).open()}),[null===F||void 0===F?void 0:F.filestackApiKey,Ye,null===H||void 0===H?void 0:H.configs]),Qe=(0,i.useMemo)((()=>(null===H||void 0===H?void 0:H.platformDomain)===r.default.CMNETWORK_DOMAIN),[null===H||void 0===H?void 0:H.platformDomain]),Ze=(0,i.useCallback)((()=>{var e,a,l,i,d;let t=(0,m.Z$)(Z,!0);var o;null!==(e=t)&&void 0!==e&&null!==(a=e.filestackPDF)&&void 0!==a&&a.mimeType||null!==(l=t)&&void 0!==l&&l.mimeType||(t=null!==Z&&void 0!==Z&&null!==(o=Z.projectDetails)&&void 0!==o&&o.filestack.length?Z.projectDetails.filestack[0]:null);(0,C.zJ)(null!==(i=t)&&void 0!==i&&null!==(d=i.filestackPDF)&&void 0!==d&&d.url?t.filestackPDF.url:t.url,null,t.filestackPDF?t.filestackPDF.mimeType:t.mimeType,t.filestackPDF?t.filestackPDF.handle:t.handle,null===F||void 0===F?void 0:F.filestackApp,null===F||void 0===F?void 0:F.jwtToken,null===H||void 0===H?void 0:H.serveFsContentViaAwsCdnEnabled,Qe)}),[Z,Qe,null===H||void 0===H?void 0:H.serveFsContentViaAwsCdnEnabled,null===F||void 0===F?void 0:F.filestackApp,null===F||void 0===F?void 0:F.jwtToken]),Ke=(0,i.useMemo)((()=>(0,m.El)({cardData:Z,userInfo:F,orgInfo:H})),[Z,F,H]),{videoInIframe:Je,videoUrl:Xe}=(0,i.useMemo)((()=>(0,m.cy)(Z,F,H)),[Z,H,F]),{isEnrollmentRequired:$e,isPaymentRequired:ea,isLockedCard:aa}=R;let la="";return $e?la=(0,T.AW)({key:"enrollmentNeededAlert",defaultTranslatedValue:s.p.SmartCardDetailView.enroll_card_mini_label}):ea?la=(0,T.AW)({key:"paymentAlert",defaultTranslatedValue:s.p.SmartCardDetailView.buy_card_mini_label}):aa&&(la=(0,T.AW)({key:"lockedCardMiniLabel",defaultTranslatedValue:s.p.SmartCardDetailView.locked_card_mini_label})),(0,S.jsxs)("div",{className:"edc-card-detail-view",children:[(0,S.jsx)(d.SmartCardDetailView,{author:(null===Z||void 0===Z||null===(V=Z.projectDetails)||void 0===V||null===(w=V.graderType)||void 0===w||null===(A=w.charAt(0))||void 0===A?void 0:A.toUpperCase())+(null===Z||void 0===Z||null===(E=Z.projectDetails)||void 0===E||null===(x=E.graderType)||void 0===x?void 0:x.slice(1)),cardImageUrl:Ke,onCardLink:()=>{Z.cardType!==r.default.CARD_SUBTYPE.SCORM?(0,m.HG)({resource:Z.resource&&Z.resource.url||(null===Z||void 0===Z?void 0:Z.shareUrl),card:Z,ldFlags:G}):(0,m.Wk)({card:Z,userInfo:F,navigate:W,ldFlags:G})},cardTitle:null===Z||void 0===Z?void 0:Z.cardTitle,cardType:null===Z||void 0===Z?void 0:Z.cardType,detailDescription:(0,S.jsx)("div",{className:"card-description-child",dangerouslySetInnerHTML:{__html:(0,k.H5)((0,k.kr)({description:(null===O||void 0===O?void 0:O.cardMessage)||(null===O||void 0===O||null===(h=O.resource)||void 0===h?void 0:h.description)||"",orgInfo:H,userInfo:F}))}}),gradeScale:null===Z||void 0===Z||null===(M=Z.projectDetails)||void 0===M?void 0:M.gradingScale,onQuizSubmittedButton:ge,openLinkText:(0,T.eO)({key:"Cards_openContent",defaultTranslatedValue:s.p.Cards.open_content}),projectViewSubmissionButton:function(){},quiz:null===Z||void 0===Z?void 0:Z.quiz,isShowQuizFilePreview:we,thumbnailImageUrl:Ke,hasQuizSubmittedButton:()=>Le(Z),onEmailDownloadReport:he,cardTextDescription:(0,S.jsx)("div",{className:"card-description-child",dangerouslySetInnerHTML:{__html:(0,k.H5)((0,k.kr)({description:(null===O||void 0===O?void 0:O.cardMessage)||(null===O||void 0===O||null===(L=O.resource)||void 0===L?void 0:L.description)||"",orgInfo:H,userInfo:F}))}}),cardSubType:null===Z||void 0===Z?void 0:Z.cardSubtype,videoURL:Xe,videoInIframe:Je,isVideoDownloadDisabled:se,audioURL:null===ye||void 0===ye?void 0:ye.filestackUrl,cardSubTypeFileId:"cardSubTypeFileId",quizPollOptions:null===Z||void 0===Z?void 0:Z.quizQuestionOptions,hasAttemptedPoll:null===Z||void 0===Z?void 0:Z.hasAttempted,attemptCount:null===Z||void 0===Z?void 0:Z.attemptCount,pollAttemptedOptions:null===Z||void 0===Z?void 0:Z.attemptedOptions,pollAttemptedOption:null===Z||void 0===Z?void 0:Z.attemptedOption,hasPollOptionVote:e=>Me(e),isSubmitPollText:J?"".concat((0,T.AW)({key:"SmartCardDetailView_voteLabel",defaultTranslatedValue:s.p.SmartCardDetailView.vote_label}),"..."):(0,T.AW)({key:"SmartCardDetailView_voteLabel",defaultTranslatedValue:s.p.SmartCardDetailView.vote_label}),isSubmitPollDisable:!!J,isShowThumbnail:ue,isShowFilestackPreview:xe,isShowAudioCardImage:void 0!==Ke,isSubmittedQuizBtnText:null!==Z&&void 0!==Z&&null!==(I=Z.quiz)&&void 0!==I&&I.hasAttempted?(0,T.AW)({key:"SmartCardDetailView_submitted",defaultTranslatedValue:s.p.SmartCardDetailView.submitted}):(0,T.AW)({key:"submit",defaultTranslatedValue:s.p.SmartCardDetailView.submit}),disableQuizButton:_e,onQuizOptionSelect:e=>{de(e)},cardData:Z,projectAssignedCount:null===z||void 0===z?void 0:z.projectAssignedCount,projectSubmissionCount:null===z||void 0===z?void 0:z.projectSubmissionCount,projectSubmissionGradeCount:null===z||void 0===z?void 0:z.projectSubmissionGradeCount,isAdmin:ne,projectAddSubmissionButton:Oe,onSubmissionClear:Ie,submissions:$,cardMetaData:R,onBuyCard:()=>le(!0),submissionProps:{projectSubmissionData:q,editSubmissionHandler:Re,submissionDeleteHandler:je,submissionUrl:$,previewFileObj:Ne,submissionClearHandler:Ie,projectUrlSubmissionHandler:async()=>{try{var e,a,l;const d={project_id:null===Z||void 0===Z?void 0:Z.id,submission:(null===$||void 0===$?void 0:$.url)||"",media:(null===$||void 0===$?void 0:$.media)||[]},[t,o]=await(0,c.WO)({submissionId:(null===Z||void 0===Z||null===(e=Z.projectSubmissionDetails)||void 0===e?void 0:e.id)||"",methodType:null!==Z&&void 0!==Z&&null!==(a=Z.projectSubmissionDetails)&&void 0!==a&&a.id?r.default.HTTP_METHOD.PUT:r.default.HTTP_METHOD.POST,payload:d,resubmit:!(null===Z||void 0===Z||null===(l=Z.projectSubmissionDetails)||void 0===l||!l.id)&&fe});var i;if(t&&(B.open((0,T.eO)({key:"Cards_projectSubmissionSuccess",defaultTranslatedValue:s.p.Cards.project_submission_success})),(null!==t&&void 0!==t&&t.projectSubmissionDetails||t)&&(Q((null===t||void 0===t?void 0:t.projectSubmissionDetails)||t),K((e=>({...e,...null!==t&&void 0!==t&&t.projectSubmissionDetails?t:{}})))),Fe(null),await Pe()),o)B.open((null===o||void 0===o||null===(i=o.data)||void 0===i?void 0:i.message)||r.default.ERRORS.MESSAGE)}catch(t){var d;B.open((null===t||void 0===t||null===(d=t.data)||void 0===d?void 0:d.message)||r.default.ERRORS.MESSAGE)}},submissionRef:U,closePopperHandler:()=>{N(null)},onValidSubmitHandler:e=>{const a=He();ee({url:e,date:a,media:null}),N(null),Q(null)},onFileUploadClick:()=>{qe("")},onFileSubmit:Ge,onFileSubmitCancel:ze,canSubmit:be,canGrade:!1,...ke?{canEdit:!1}:{attempts:Te,reattempts:me}},media:Se,onProjectClickFile:Ze,overlayText:la,isShowQuizAudioFilePreview:Ae,isShowQuizVideoFilePreview:Ee,buyNowText:(0,T.AW)({key:"buyNow",defaultTranslatedValue:s.p.SmartCardDetailView.buy_now}),enrollNowText:(0,T.AW)({key:"enrollNow",defaultTranslatedValue:s.p.SmartCardDetailView.enroll_now}),scheduledLabelText:(0,T.AW)({key:"scheduled",defaultTranslatedValue:s.p.SmartCardDetailView.scheduled}),liveLabelText:(0,T.AW)({key:"live",defaultTranslatedValue:s.p.SmartCardDetailView.live}),endedLabelText:(0,T.AW)({key:"ended",defaultTranslatedValue:s.p.SmartCardDetailView.ended}),liveStreamEndedText:(0,T.AW)({key:"livestreamEnded",defaultTranslatedValue:s.p.SmartCardDetailView.livestream_ended}),videoReplayText:(0,T.AW)({key:"videoReplay",defaultTranslatedValue:s.p.SmartCardDetailView.video_replay}),correctText:(0,T.AW)({key:"SmartCardDetailView_correct",defaultTranslatedValue:s.p.SmartCardDetailView.correct}),incorrectText:(0,T.AW)({key:"SmartCardDetailView_incorrect",defaultTranslatedValue:s.p.SmartCardDetailView.incorrect}),mandatoryErrorText:(0,T.AW)({key:"SmartCardDetailView_mandatoryQuestion",defaultTranslatedValue:s.p.SmartCardDetailView.mandatory_question}),answerAllErrorText:(0,T.AW)({key:"SmartCardDetailView_answerAllQuestions",defaultTranslatedValue:s.p.SmartCardDetailView.answer_all_questions}),resultsLabelText:(0,T.AW)({key:"SmartCardDetailView_results",defaultTranslatedValue:s.p.SmartCardDetailView.results}),responseLabelText:(0,T.AW)({key:"SmartCardDetailView_response",defaultTranslatedValue:s.p.SmartCardDetailView.response}),passedLabelText:(0,T.AW)({key:"SmartCardDetailView_passed",defaultTranslatedValue:s.p.SmartCardDetailView.passed}),failedLabelText:(0,T.AW)({key:"SmartCardDetailView_failed",defaultTranslatedValue:s.p.SmartCardDetailView.failed}),averageScoreLabelText:(0,T.AW)({key:"SmartCardDetailView_averageScore",defaultTranslatedValue:s.p.SmartCardDetailView.average_score}),answerAgainButtonText:(0,T.AW)({key:"SmartCardDetailView_answerAgain",defaultTranslatedValue:s.p.SmartCardDetailView.answer_again}),totalVotesPolledLabelText:(0,T.AW)({key:"SmartCardDetailView_totalVotesPolled",defaultTranslatedValue:s.p.SmartCardDetailView.total_votes_polled}),pollNoVotesLabel:(0,T.AW)({key:"pollNoVote",defaultTranslatedValue:s.p.SmartCardDetailView.poll_no_vote}),pollVoteSingular:(0,T.AW)({key:"pollSingular",defaultTranslatedValue:s.p.SmartCardDetailView.poll_singular}),pollVotePlural:(0,T.AW)({key:"pollPlural",defaultTranslatedValue:s.p.SmartCardDetailView.poll_plural}),gradeScaleLabelText:(0,T.AW)({key:"SmartCardDetailView_gradeScale",defaultTranslatedValue:s.p.SmartCardDetailView.grade_scale}),gradeLabelText:(0,T.AW)({key:"SmartCardDetailView_grade",defaultTranslatedValue:s.p.SmartCardDetailView.grade}),graderLabelText:(0,T.AW)({key:"SmartCardDetailView_grader",defaultTranslatedValue:s.p.SmartCardDetailView.grader}),assignedLabelText:(0,T.AW)({key:"assigned",defaultTranslatedValue:s.p.SmartCardDetailView.assigned}),submittedLabelText:(0,T.AW)({key:"SmartCardDetailView_submitted",defaultTranslatedValue:s.p.SmartCardDetailView.submitted}),gradedLabelText:(0,T.AW)({key:"SmartCardDetailView_graded",defaultTranslatedValue:s.p.SmartCardDetailView.graded}),viewSubmissionButtonText:(0,T.AW)({key:"SmartCardDetailView_viewSubmissions",defaultTranslatedValue:s.p.SmartCardDetailView.view_submissions}),addSubmissionButtonText:(0,T.AW)({key:"SmartCardDetailView_addSubmissions",defaultTranslatedValue:s.p.SmartCardDetailView.add_submissions}),resubmitButtonText:(0,T.AW)({key:"SmartCardDetailView_resubmit",defaultTranslatedValue:s.p.SmartCardDetailView.resubmit}),editButtonText:(0,T.AW)({key:"edit",defaultTranslatedValue:s.p.SmartCardDetailView.edit}),submitButtonText:(0,T.AW)({key:"submit",defaultTranslatedValue:s.p.SmartCardDetailView.submit}),remarksLabelText:(0,T.AW)({key:"SmartCardDetailView_remarks",defaultTranslatedValue:s.p.SmartCardDetailView.remarks}),orLabelText:(0,T.AW)({key:"SmartCardDetailView_or",defaultTranslatedValue:s.p.SmartCardDetailView.or}),addUrlButtonText:(0,T.AW)({key:"SmartCardDetailView_addUrl",defaultTranslatedValue:s.p.SmartCardDetailView.add_url}),uploadFileButtonText:(0,T.AW)({key:"uploadFileText",defaultTranslatedValue:s.p.SmartCardDetailView.upload_file}),addSubmissionBoxErrorText:(0,T.AW)({key:"SmartCardDetailView_validUrl",defaultTranslatedValue:s.p.SmartCardDetailView.valid_url}),closeButtonText:(0,T.AW)({key:"close",defaultTranslatedValue:s.p.SmartCardDetailView.close}),uploadNewFileButtonText:(0,T.AW)({key:"uploadNewFile",defaultTranslatedValue:s.p.SmartCardDetailView.upload_new_file}),urlSubmissionLabelText:(0,T.AW)({key:"SmartCardDetailView_urlSubmission",defaultTranslatedValue:s.p.SmartCardDetailView.url_submission}),emailMeReportButtonLabel:(0,T.AW)({key:"SmartCardDetailView_emailLabel",defaultTranslatedValue:s.p.SmartCardDetailView.email_label}),uploadFileLabelText:(0,T.AW)({key:"SmartCardDetailView_uploadFileLabel",defaultTranslatedValue:s.p.SmartCardDetailView.upload_file_label}),openContentLabel:(0,T.AW)({key:"SmartCardDetailView_openContentLabel",defaultTranslatedValue:s.p.SmartCardDetailView.open_content_label}),allMandatoryHelpText:(0,T.AW)({key:"allMandatoryQuestions",defaultTranslatedValue:s.p.SmartCardDetailView.all_mandatory_help_text})}),o.createPortal((0,S.jsx)("div",{children:ae?(0,S.jsx)(n.M,{isModalOpen:ae,closeModal:()=>le(!1),cardData:R}):null}),document.body)]})};var _=l(2378),D=l(6442),y=l(1180),g=l(6333),V=l(1839),w=l(7541),A=l(1178),E=l(2414),x=l(224);const h=e=>{var a,l,n,p,b,f,_,h;let{cardData:M,onLikeClick:L,isLiked:I,permissions:O,cardMetaData:P,setCardData:R=(()=>{}),toggleCardLock:j=(()=>{}),getCardDetailViewData:W=(()=>{})}=e;const B=(0,v.p)(),U=(0,t.s0)(),{userInfo:N,ldFlags:F,rootElement:H}=(0,i.useContext)(u.Il),G=(0,i.useContext)(w.Z),[z,Y]=(0,i.useState)(null===M||void 0===M?void 0:M.averageRating),[q,Q]=(0,i.useState)(!1),[Z,K]=(0,i.useState)(!1),[J,X]=(0,i.useState)(!1),[$,ee]=(0,i.useState)((null===M||void 0===M?void 0:M.completionState)!==r.default.COMPLETED&&null!==!(null!==M&&void 0!==M&&M.completionState)),[ae,le]=(0,i.useState)(!1),[ie,de]=(0,i.useState)(!1),te=(0,i.useCallback)((async e=>{const[a,l]=await(0,c.oM)({cardId:null===M||void 0===M?void 0:M.id,rate:e});var i;a&&null!==a&&void 0!==a&&a.averageRating&&!l?(R(a),Y((null===a||void 0===a?void 0:a.averageRating)||e)):(Y(null===M||void 0===M?void 0:M.averageRating),B.open((null===l||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message)||(0,T.eO)({key:"errorMessage",defaultTranslatedValue:s.p.Cards.error_message})))}),[null===M||void 0===M?void 0:M.averageRating,null===M||void 0===M?void 0:M.id,R,B]),oe=(0,i.useCallback)((()=>{!(null!==M&&void 0!==M&&M.isPublic)?K(!0):X(!0)}),[M.isPublic]),ne=(0,i.useCallback)((async()=>{if($){const a={use_mark_as_complete_v2:!0,completion_language:null===M||void 0===M?void 0:M.language,state:r.default.COMPLETE};null!==M&&void 0!==M&&M.contextId&&null!==M&&void 0!==M&&M.contextType&&(a.context_id=M.contextId,a.context_type=M.contextType);const[l,i]=await(0,c.fN)({cardId:null===M||void 0===M?void 0:M.id,payload:a});var e;if(l&&(ee(!1),j(null===M||void 0===M?void 0:M.id),await W({enableLoader:!1}),B.open((0,T.eO)({key:"completedSmartcard",defaultTranslatedValue:s.p.Cards.mark_as_complete}))),i)B.open((null===i||void 0===i||null===(e=i.data)||void 0===e?void 0:e.message)||(0,T.eO)({key:"errorMessage",defaultTranslatedValue:s.p.Cards.error_message}))}else Q(!0)}),[null===M||void 0===M?void 0:M.contextId,null===M||void 0===M?void 0:M.contextType,null===M||void 0===M?void 0:M.id,null===M||void 0===M?void 0:M.language,W,$,B,j]),re=(0,i.useCallback)((async()=>{const e={use_mark_as_complete_v2:!0};null!==M&&void 0!==M&&M.contextId&&null!==M&&void 0!==M&&M.contextType&&(e.context_id=M.contextId,e.context_type=M.contextType);const[a,l]=await(0,c.Fk)({cardId:null===M||void 0===M?void 0:M.id,payload:e});var i;(a&&(ee(!0),Q(!1),j(null===M||void 0===M?void 0:M.id),await W({enableLoader:!1}),B.open((0,T.eO)({key:"Cards_markAsIncomplete",defaultTranslatedValue:s.p.Cards.mark_as_incomplete}))),l)&&(Q(!1),B.open((null===l||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message)||(0,T.eO)({key:"errorMessage",defaultTranslatedValue:s.p.Cards.error_message})))}),[null===M||void 0===M?void 0:M.contextId,null===M||void 0===M?void 0:M.contextType,null===M||void 0===M?void 0:M.id,W,B,j]),se=(0,i.useMemo)((()=>{let e=[];return O.isLikeCardEnabled&&e.push({icon:I?(0,S.jsx)(d.FilledLikeIcon,{}):(0,S.jsx)(d.LikeIcon,{}),text:(0,T.AW)({key:"like",defaultTranslatedValue:s.p.SmartCardDetailView.like}),onClick:()=>{L(r.default.ICONS.like)}}),O.isCommentCardEnabled&&e.push({icon:(0,S.jsx)(d.CommentIcon,{}),onClick:()=>{H.getElementsByClassName("edc-comment-input")[0].focus()},text:(0,T.AW)({key:"SmartCardDetailView_comment",defaultTranslatedValue:s.p.SmartCardDetailView.comment})}),O.isShareCardEnabled&&e.push({icon:(0,S.jsx)(d.ShareIcon,{}),onClick:()=>{oe()},text:(0,T.eO)({key:"share",defaultTranslatedValue:s.p.Cards.share})}),e}),[I,L,oe,O.isCommentCardEnabled,O.isLikeCardEnabled,O.isShareCardEnabled,H]),ue=(0,i.useMemo)((()=>(0,A.k)({card:M,cardType:null===P||void 0===P?void 0:P.type,userInfo:N,ld:F})),[M,N,F,null===P||void 0===P?void 0:P.type]),ve=(0,i.useMemo)((()=>(0,E.nE)({card:M,cardType:null===P||void 0===P?void 0:P.type,userInfo:N,permissions:O,ld:F})),[M,F,null===P||void 0===P?void 0:P.type,O,N]),ce=(0,S.jsx)("div",{className:"edc-mark-incomplete-body",children:(0,T.AW)({key:"SmartCardDetailView_completionSupportAlertText",defaultTranslatedValue:s.p.SmartCardDetailView.completion_support_alert_text})}),me=(0,i.useMemo)((()=>{var e;return null===M||void 0===M||null===(e=M.channels)||void 0===e?void 0:e.filter((e=>!e.isPrivate))}),[null===M||void 0===M?void 0:M.channels]),pe=(0,i.useCallback)((e=>{U("".concat(r.default.PAGES.CHANNEL_DETAIL,"/").concat(null===e||void 0===e?void 0:e.id))}),[U]),Ce=(0,i.useCallback)((e=>{U("".concat(r.default.PAGES.GROUP_DETAIL,"/").concat(null===e||void 0===e?void 0:e.id))}),[U]);(0,i.useEffect)((()=>{Y(null===M||void 0===M?void 0:M.averageRating)}),[null===M||void 0===M?void 0:M.averageRating]);const Te=(0,i.useMemo)((()=>(0,m.GJ)(null===N||void 0===N?void 0:N.isAdmin,null===N||void 0===N?void 0:N.permissions)),[null===N||void 0===N?void 0:N.isAdmin,null===N||void 0===N?void 0:N.permissions]),ke=(0,i.useCallback)((async e=>{le(!0);const[a,l]=await(0,c.Aj)({trainingId:e});l&&B.open((0,T.eO)({key:"Cards_registrationFailed",defaultTranslatedValue:s.p.Cards.registration_failed})),a&&(await W({enableLoader:!1}),B.open((0,T.eO)({key:"key",defaultTranslatedValue:V.w.SmartCardDetailView.liveEventRegisteredMessage}))),le(!1)}),[W,B]),Se=(0,i.useCallback)((async e=>{le(!0);const[a,l]=await(0,c.f$)({trainingId:e});l&&B.open((0,T.eO)({key:"Cards_registrationFailed",defaultTranslatedValue:s.p.Cards.registration_failed})),a&&(await W({enableLoader:!1}),B.open((0,T.eO)({key:"key",defaultTranslatedValue:V.w.SmartCardDetailView.liveEventUnRegisteredMessage}))),le(!1),de(!1)}),[B,W]),be=(0,i.useCallback)((()=>{de(!1)}),[]),fe=(0,S.jsx)("div",{className:"edc-live-modal-body",children:(0,T.AW)({key:"KEY",defaultTranslatedValue:V.w.SmartCardDetailView.unRegistrationConfirmationBody})}),_e=(0,S.jsx)("div",{className:"edc-private-share-modal-body",children:(0,T.Fr)({key:"MiniCard_sharePrivateCardInfoText",defaultTranslatedValue:null===(a=s.p.MiniCard.share_private_card_info_text)||void 0===a?void 0:a.replace("{{cardType}}",(0,x.Aw)(null===P||void 0===P?void 0:P.readableCardType)),variables:{cardType:(0,x.Aw)(null===P||void 0===P?void 0:P.readableCardType)}})}),De=(0,i.useMemo)((()=>[r.default.CARD_SUBTYPE.QUIZ,r.default.CARD_SUBTYPE.POLL].includes(M.cardType)||ue),[M.cardType,ue]);return(0,S.jsxs)("div",{className:"edc-widget-card-detail-view-footer",children:[(0,S.jsx)(d.DetailViewFooter,{cardDetails:M,liveCardDetails:(e=>{var a,l,i,d,t,o;const n=(null===e||void 0===e?void 0:e.trainingDetails)||(null===e||void 0===e||null===(a=e.additional_metadata)||void 0===a?void 0:a.trainingDetails)||(null===e||void 0===e||null===(l=e.additional_metadata)||void 0===l?void 0:l.training_details)||{},u=n.startDate||n.start_date||"",v=n.endDate||n.end_date||"",c=G(new Date).tz(G.tz.guess()).format("z"),p=(0,k.SU)({date:u,moment:G}),C=(0,k.SU)({date:v,moment:G}),S=(0,k.SU)({date:u,format:"hh:mm A",moment:G}),b=(0,k.SU)({date:v,format:"hh:mm A",moment:G}),{trainingDetails:f}=e,{lastRegistrationDate:_,registrationsCount:D,registrationLimit:y,id:g}=f,w=!!y&&y<=D,A=!!_&&!G().isSameOrBefore(_),E=_?G(G.utc(_)).local().format("DD MMM, YYYY"):"",x=(0,m.$g)({disableRegistrationLimit:w,disableRegistrationDate:A,viltRegistrationLimit:y,viltLastRegistrationDate:E}),h=(0,m._E)({authorId:null===e||void 0===e||null===(i=e.author)||void 0===i?void 0:i.id,userId:(0,m.n5)(N)}),M=(null===f||void 0===f||null===(d=f.registrations)||void 0===d?void 0:d.state)||"",L=M===r.default.LIVE_ATTENDEES_TABS.REJECTED;let I="";I=null!==f&&void 0!==f&&f.recordingDetails?null===f||void 0===f?void 0:f.recordingDetails:null===f||void 0===f?void 0:f.meetingDetails;return{dateRange:p&&C?"".concat(p," - ").concat(C):"",timeRange:S&&b?"".concat(S," - ").concat(b):"",timeZone:c||"",showMeetingDetails:!0,isAdmin:Te,isCardOwner:h,isCardCompleted:(null===e||void 0===e||null===(t=e.completionState)||void 0===t?void 0:t.toUpperCase())===r.default.COMPLETED,icsFile:n.icsFile,configData:!0,viewAttendeesLabel:(0,T.AW)({key:"viewAttendeesLabel",defaultTranslatedValue:V.w.SmartCardDetailView.viewAttendeesLabel}),registeredLabel:(0,T.AW)({key:"SmartCardDetailView_registered",defaultTranslatedValue:s.p.SmartCardDetailView.registered}),addToCalendarLabel:(0,T.AW)({key:"addToCalendarLabel",defaultTranslatedValue:V.w.SmartCardDetailView.addToCalendarLabel}),meetingLinkLabel:(0,T.AW)({key:"meetingLinkLabel",defaultTranslatedValue:V.w.SmartCardDetailView.meetingLinkLabel}),recordingURLLabel:(0,T.AW)({key:"recordingURLLabel",defaultTranslatedValue:V.w.SmartCardDetailView.recordingURLLabel}),registerMeetingLinkLabel:(0,T.AW)({key:"registerMeetingLinkLabel",defaultTranslatedValue:V.w.SmartCardDetailView.registerMeetingLinkLabel}),pendingApprovalLabel:(0,T.AW)({key:"pendingApprovalLabel",defaultTranslatedValue:V.w.SmartCardDetailView.pendingApprovalLabel}),accessDeniedLabel:(0,T.AW)({key:"accessDeniedLabel",defaultTranslatedValue:V.w.SmartCardDetailView.accessDeniedLabel}),liveDateLabel:"".concat((0,T.eO)({key:"Cards_date",defaultTranslatedValue:s.p.Cards.date}),": "),liveDateTime:"".concat((0,T.eO)({key:"Cards_time",defaultTranslatedValue:s.p.Cards.time}),": "),registerButtonLabel:(0,T.AW)({key:"SmartCardDetailView_registered",defaultTranslatedValue:s.p.SmartCardDetailView.registered}),unRegisterButtonLabel:(0,T.AW)({key:"SmartCardDetailView_unregister",defaultTranslatedValue:s.p.SmartCardDetailView.unregister}),closingMessage:x,viltRegistrationStatus:M,disableRegistrationDate:A,isShowRegisterButton:!L&&!h,onRegisterCallBack:()=>ke(g),onUnRegisterCallBack:()=>{de(!0)},isDisabled:(0,m.$e)({disabledRegisterSubmit:ae,viltRegistrationStatus:M,isOwner:h,cardCompleted:(null===e||void 0===e||null===(o=e.completionState)||void 0===o?void 0:o.toUpperCase())===r.default.COMPLETED,disableRegistrationLimit:w,disableRegistrationDate:A}),getClassForRegistrationButtonObject:(0,m.R6)({disabledRegisterSubmit:ae,viltRegistrationStatus:M,isOwner:h,disableRegistrationLimit:w,disableRegistrationDate:A}),onAttendeesClick:()=>{U("".concat(r.default.PAGES.LIVE_EVENT_ATTENDEES_PAGE,"/").concat(null===e||void 0===e?void 0:e.id))},onIcsLink:()=>{if(null!==f&&void 0!==f&&f.icsFile){const e=document.createElement("a");e.href=null===f||void 0===f?void 0:f.icsFile,e.download="ical.ics",document.body.appendChild(e),e.click(),e.remove()}},onURLLink:()=>{window.open(I,"_blank")}}})(M),avatarImages:O.isLikeCardEnabled&&null!==(l=null===M||void 0===M||null===(n=M.voters)||void 0===n?void 0:n.map((e=>({imgSrc:(0,C.HK)(e)}))))&&void 0!==l?l:[],completed:De,credits:(null===M||void 0===M?void 0:M.eclSourceCpeCredits)&&"".concat(null===M||void 0===M?void 0:M.eclSourceCpeCredits),difficulty:O.isProficiencyLevelsAccessible&&(null===P||void 0===P?void 0:P.skillLevel),translatedSkillLevelToolTipText:null===P||void 0===P?void 0:P.translatedSkillLevelDesc,duration:null===P||void 0===P?void 0:P.duration,footerButtons:se,isAssignedBy:!0,isDueDate:!0,language:null===P||void 0===P?void 0:P.language,numberOfComments:O.isCommentCardEnabled&&null!==(p=null===M||void 0===M?void 0:M.commentsCount)&&void 0!==p?p:0,numberOfLikes:O.isLikeCardEnabled&&null!==(b=null===M||void 0===M?void 0:M.votesCount)&&void 0!==b?b:0,markAsCompleteText:$?(0,T.AW)({key:"SmartCardDetailView_markAsCompleted",defaultTranslatedValue:s.p.SmartCardDetailView.mark_as_completed}):(0,T.AW)({key:"completed",defaultTranslatedValue:s.p.SmartCardDetailView.completed}),onMarkComplete:ne,smartcardType:null!==(f=null===P||void 0===P?void 0:P.readableCardType)&&void 0!==f?f:"",isPrivate:!(null!==M&&void 0!==M&&M.isPublic),isShowMarkAsCompleteEnabled:ve,price:null===P||void 0===P?void 0:P.price,cpeCreditsLabelText:(0,T.AW)({key:"SmartCardDetailView_creditsTextLabel",defaultTranslatedValue:s.p.SmartCardDetailView.credits_label_text}),privateLabelText:(0,T.AW)({key:"privateTextLabel",defaultTranslatedValue:s.p.SmartCardDetailView.private_label_text}),tagLabelText:(0,T.AW)({key:"tags",defaultTranslatedValue:s.p.SmartCardDetailView.tag_label}),labels:null!==(_=null===M||void 0===M||null===(h=M.tags)||void 0===h?void 0:h.map((e=>e.name)))&&void 0!==_?_:[],channelText:(0,T.AW)({key:"channelText",defaultTranslatedValue:s.p.SmartCardDetailView.channel_label}),channels:me,onChannelClick:pe,sharedWithTeamsText:(0,T.AW)({key:"SmartCardDetailView_sharedLabel",defaultTranslatedValue:s.p.SmartCardDetailView.shared_label}),sharedWithTeams:null===M||void 0===M?void 0:M.teams,sharedWithTeamsClick:Ce,...O.isRatingEnabled?{ratingValue:z,onRatingChange:e=>{Y(e),te(e)},ratingEditable:!0}:{},commentPluralLabel:(0,T.AW)({key:"commentPluralLabel",defaultTranslatedValue:s.p.SmartCardDetailView.comment_plural_label}),commentSingularlLabel:(0,T.AW)({key:"commentSingularLabel",defaultTranslatedValue:s.p.SmartCardDetailView.comment_singular_label}),likePluralLabel:(0,T.AW)({key:"likePluralLabel",defaultTranslatedValue:s.p.SmartCardDetailView.like_plural_label}),likeSingularLabel:(0,T.AW)({key:"likeSingularLabel",defaultTranslatedValue:s.p.SmartCardDetailView.like_singular_label}),isLikeEnabled:null===O||void 0===O?void 0:O.isLikeCardEnabled,isCommentCardEnabled:null===O||void 0===O?void 0:O.isCommentCardEnabled,starText:(0,T.eO)({key:"star",defaultTranslatedValue:V.w.Cards.star}),starPluralText:(0,T.eO)({key:"stars",defaultTranslatedValue:V.w.Cards.stars})}),o.createPortal((0,S.jsx)("div",{children:J?(0,S.jsx)(g.r,{isModalOpen:J,closeModal:()=>X(!1),cardData:M,isPrivate:!(null!==M&&void 0!==M&&M.isPublic)}):null}),document.body),o.createPortal((0,S.jsx)("div",{children:q?(0,S.jsx)(D.D,{isModalOpen:q,closeModal:()=>Q(!1),modalBody:ce,onMarkAsInComplete:re}):null}),document.body),o.createPortal((0,S.jsx)("div",{children:Z?(0,S.jsx)(y.H,{isModalOpen:Z,closeModal:()=>K(!1),modalBody:_e,onSharePrivateCallback:()=>X(!0)}):null}),document.body),o.createPortal((0,S.jsx)("div",{children:ie?(0,S.jsx)(d.Modal,{isModalOpen:ie,modalHeaderData:{headerString:(0,T.eO)({key:"key",defaultTranslatedValue:V.w.SmartCardDetailView.unRegistrationConfirmationLabel}),closeModal:be},modalBodyData:fe,modalFooterData:{cancelButtonText:(0,T.a3)({key:"Modal_no",defaultTranslatedValue:s.p.Modal.no}),submitButtonText:(0,T.a3)({key:"Modal_yes",defaultTranslatedValue:s.p.Modal.yes}),closeModal:be,submitButtonCallback:()=>{var e;Se(null===M||void 0===M||null===(e=M.trainingDetails)||void 0===e?void 0:e.id)}}}):null}),document.body)]})};var M=l(9467),L=l(2098);const I=e=>{let{recordAvailabilityMessage:a=""}=e;return(0,S.jsx)("div",{className:"edc-no-content-found",children:(0,S.jsx)("p",{className:"edc-no-content-message",children:a})})};var O=l(5886);const P=e=>{var a,l,o,n,p;let{cardId:b="",contextId:D="",contextType:y="",isPrivateCard:g=!1,isLockedCard:V=!1,toggleCardLock:w=(()=>{})}=e;const{userInfo:A,orgInfo:E,rootElement:x}=(0,i.useContext)(u.Il),P=(0,v.p)(),R=(0,t.TH)(),[j,W]=(0,i.useState)({}),[B,U]=(0,i.useState)({}),[N,F]=(0,i.useState)({}),[H,G]=(0,i.useState)({}),[z,Y]=(0,i.useState)(!0),[q,Q]=(0,i.useState)(!1),[Z,K]=(0,i.useState)(null),[J,X]=(0,i.useState)({}),[$,ee]=(0,i.useState)(),[ae,le]=(0,i.useState)(!1),[ie,de]=(0,i.useState)({is_liked:!1,is_bookmarked:!1}),[te,oe]=(0,i.useState)({}),[ne,re]=(0,i.useState)(),se=(0,i.useMemo)((()=>j.cardType===r.default.CARD_TYPE.PROJECT),[j.cardType]),ue=(0,i.useCallback)((async function(){let{enableLoader:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&Y(!0);const[a,l]=await(0,c.Od)({methodType:r.default.HTTP_METHOD.GET,cardId:b||R.pathname.split("/")[2]});if(se){const[e,a]=await(0,c.Gq)({cardId:b||R.pathname.split("/")[2],methodType:r.default.HTTP_METHOD.GET});e&&oe(e),a&&P.open((0,T.eO)({key:"Cards_cardMetricsError",defaultTranslatedValue:s.p.Cards.card_metrics_error}))}if(K(l?(0,T.eO)({key:"Cards_contentNotAvailable",defaultTranslatedValue:s.p.Cards.content_not_available}):a),a){W({...a,contextId:D,contextType:y});const{card:e,permissions:l,cardMetaData:i}=(0,m.mo)({cardData:a||{},userInfo:A,orgInfo:E,actionIcons:{is_liked:null===a||void 0===a?void 0:a.isUpvoted,is_bookmarked:null===a||void 0===a?void 0:a.isBookmarked},isAssignedToMe:!1});le(null===a||void 0===a?void 0:a.isUpvoted),Q(null===a||void 0===a?void 0:a.isBookmarked),de({is_liked:a&&(null===a||void 0===a?void 0:a.isUpvoted),is_bookmarked:a&&(null===a||void 0===a?void 0:a.isBookmarked)}),F({...e,contextId:D,contextType:y}),X(l),U(i)}else W({});Y(!1)}),[b,R,se,P,D,y,A,E]),ve=(0,i.useCallback)((async e=>{let a=j;const l=e===r.default.ICONS.like,i=e===r.default.ICONS.bookmark,d=ie[l?"is_liked":"is_bookmarked"]?r.default.HTTP_METHOD.DELETE:r.default.HTTP_METHOD.POST,[,t]=await(0,m.Sq)({actionType:e,methodType:d,userInfo:A,miniCardData:j});if(t){var o,n;P.open(null!==(o=null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)&&void 0!==o?o:(0,T.eO)({key:"errorMessage",defaultTranslatedValue:s.p.Cards.error_message}))}else{if(de({...ie,[l?"is_liked":"is_bookmarked"]:!ie[l?"is_liked":"is_bookmarked"]}),l){var u;a.votesCount+=d===r.default.HTTP_METHOD.POST?1:-1,a.isUpvoted=!a.isUpvoted,le(null===a||void 0===a?void 0:a.isUpvoted);const e=null===a||void 0===a||null===(u=a.voters)||void 0===u?void 0:u.findIndex((e=>e.id===A.id));var v,c;if(-1!==e)null===a||void 0===a||null===(v=a.voters)||void 0===v||v.splice(e,1);else null===a||void 0===a||null===(c=a.voters)||void 0===c||c.push({id:null===A||void 0===A?void 0:A.id,handle:null===A||void 0===A?void 0:A.id,name:null===A||void 0===A?void 0:A.name,avatarimages:null===A||void 0===A?void 0:A.avatarimages})}else if(i){a.isBookmarked=d===r.default.HTTP_METHOD.POST,a.isBookmarked=!a.isBookmarked;let e=a.isBookmarked?"unbookmark_message":"bookmark_message",l=a.isBookmarked?"unbookmarked":"Cards_bookmarkMessage";a.cardType===r.default.CARD_TYPE.JOURNEY&&(e=a.isBookmarked?"journey_unbookmark_message":"journey_bookmark_message",l=a.isBookmarked?"Cards_journeyUnbookmarkMessage":"Cards_journeyBookmarkMessage"),a.cardType===r.default.CARD_TYPE.PATHWAY&&(e=a.isBookmarked?"pathway_unbookmark_message":"pathway_bookmark_message",l=a.isBookmarked?"Cards_pathwayUnbookmarkMessage":"Cards_pathwayBookmarkMessage"),P.open((0,T.eO)({key:l,defaultTranslatedValue:s.p.Cards[e]})),Q(!(null!==a&&void 0!==a&&a.isBookmarked))}F(a)}}),[j,ie,A,P]),ce=(0,i.useCallback)((e=>{F((a=>({...a,commentsCount:a.commentsCount+e})))}),[F]);return(0,i.useEffect)((()=>{g?Y(!1):ue()}),[ue,g]),(0,i.useEffect)((()=>{if(j){const e=(0,m.Yc)({card:j,userInfo:A,orgInfo:E});X(e)}}),[j,E,A]),(0,i.useEffect)((()=>{ee((0,O.x)({permissions:J}))}),[J]),(0,i.useEffect)((()=>{var e,a,l,i,d,t,o;const n={avatarImage:(0,C.HK)(null===j||void 0===j?void 0:j.author),jobTitle:null===j||void 0===j||null===(e=j.author)||void 0===e||null===(a=e.profile)||void 0===a?void 0:a.jobTitle,name:(null===j||void 0===j||null===(l=j.author)||void 0===l?void 0:l.fullName)||(null===j||void 0===j||null===(i=j.author)||void 0===i?void 0:i.name),assignedBy:null===j||void 0===j||null===(d=j.assigner)||void 0===d?void 0:d.fullName,dateAssigned:(0,m.L0)({date:null===j||void 0===j||null===(t=j.assignment)||void 0===t?void 0:t.assigned_date,format:r.default.DATE_FORMAT.month_name_year}),dateCreated:(0,m.L0)({date:null===j||void 0===j?void 0:j.createdAt,format:r.default.DATE_FORMAT.month_name_year}),dueDate:(0,m.L0)({date:null===j||void 0===j||null===(o=j.assignment)||void 0===o?void 0:o.due_at,format:r.default.DATE_FORMAT.month_name_year})};var s,u;null!==B&&void 0!==B&&B.isShowProvider&&(n.avatarImage=null===B||void 0===B||null===(s=B.provider)||void 0===s?void 0:s.imgSrc,n.jobTitle=null,n.name=null===B||void 0===B||null===(u=B.provider)||void 0===u?void 0:u.fullName);G(n)}),[null===j||void 0===j||null===(a=j.assigner)||void 0===a?void 0:a.fullName,null===j||void 0===j||null===(l=j.assignment)||void 0===l?void 0:l.assigned_date,null===j||void 0===j||null===(o=j.assignment)||void 0===o?void 0:o.due_at,null===j||void 0===j?void 0:j.author,null===j||void 0===j?void 0:j.createdAt,null===B||void 0===B?void 0:B.isShowProvider,null===B||void 0===B||null===(n=B.provider)||void 0===n?void 0:n.fullName,null===B||void 0===B||null===(p=B.provider)||void 0===p?void 0:p.imgSrc]),(0,S.jsxs)(S.Fragment,{children:[(0,k.xb)(b)?(0,S.jsx)(M.Z,{}):null,z?(0,S.jsx)(d.Spinner,{variant:"lg"}):V?(0,S.jsx)("div",{className:"edc-card-detail-view-locked-card-container",children:(0,S.jsx)(d.CardOverlay,{variant:"locked",overlayText:(0,T.XQ)({key:"lockedCardMiniLabel",defaultTranslatedValue:s.p.CardOverlayText.locked_card_alert}),buyNowText:(0,T.eO)({key:"buyNow",defaultTranslatedValue:s.p.Cards.buy_now}),enrollNowText:(0,T.eO)({key:"enrollNow",defaultTranslatedValue:s.p.Cards.enroll_now})})}):j&&((0,k.xb)(b)||b===(null===j||void 0===j?void 0:j.id))||!g?null!==Z&&void 0!==Z&&Z.id?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"edc-card-detail-view-container",children:[(0,S.jsx)(_.Z,{cardData:N,cardMetaData:B,onBookmarkClick:ve,contextMenuOptions:$,permissions:J,setPermissions:X,isBookmarked:q,creatorData:H,setCreatorData:G,setCardData:W,rootElement:x}),(0,S.jsx)(f,{cardData:N,cardMetricsData:te,cardMetaData:B,setHideMarkAsComplete:re,getCardDetailViewData:ue,rootElement:x}),(0,S.jsx)("div",{children:(0,S.jsx)("hr",{className:"edc-divider-root"})}),(0,S.jsx)(h,{cardData:N,cardMetaData:B,onLikeClick:ve,isLiked:ae,permissions:J,hideMarkAsComplete:ne,setCardData:W,toggleCardLock:w,getCardDetailViewData:ue})]}),J.isCommentCardEnabled?(0,S.jsx)("div",{className:"edc-card-detail-view-comment-container",children:(0,S.jsx)(L.Z,{id:null===j||void 0===j?void 0:j.id,setCommentCount:ce})}):null]}):(0,S.jsx)(I,{recordAvailabilityMessage:Z}):(0,S.jsx)("div",{className:"edc-smart-card-detail-view-private-card",children:(0,S.jsx)(d.PrivateCardOverlay,{text:(0,T.eO)({key:"privateCardAlert",defaultTranslatedValue:s.p.Cards.private_card_alert})})})]})}},2378:(e,a,l)=>{l.d(a,{Z:()=>y});var i=l(1649),d=l(2143),t=l(4945),o=l(3442),n=l(710),r=l(7588),s=l(6873),u=l(4270),v=l(4584),c=l(4607),m=l(8176),p=l(2856),C=l(5490),T=l(8984),k=l(7541),S=l(5201),b=l(5886),f=l(7064),_=l(8079),D=l(8170);const y=e=>{var a,l,y,g,V,w;let{cardData:A,cardMetaData:E,onBookmarkClick:x,contextMenuOptions:h,isBookmarked:M,creatorData:L,permissions:I,setPermissions:O,setCardData:P=(()=>{}),liveCardPreviewImage:R=""}=e;const{userInfo:j,orgInfo:W,rootElement:B}=(0,i.useContext)(T.Il),U=(0,i.useContext)(k.Z),N=(0,o.s0)(),[F,H]=(0,i.useState)(!1),[G,z]=(0,i.useState)(!1),[Y,q]=(0,i.useState)(!1),[Q,Z]=(0,i.useState)(!1),[K,J]=(0,i.useState)(!1),[X,$]=(0,i.useState)(!1),[ee,ae]=(0,i.useState)(!1),[le,ie]=(0,i.useState)(!1),[de,te]=(0,i.useState)(!1),[oe,ne]=(0,i.useState)(!1),{isShowAuthor:re=!1,isShowProvider:se=!1}=E,ue=(0,i.useMemo)((()=>{var e,a;return W&&(null===(e=W.configs)||void 0===e||null===(a=e.find((e=>e.name===p.default.ADMIN_CONFIG.ENABLE_SHOW_CREATOR)))||void 0===a?void 0:a.value)||!1}),[W]),ve=(0,i.useMemo)((()=>re&&se||re?p.default.CARD_AVATAR_TYPE.AUTHOR:se?p.default.CARD_AVATAR_TYPE.PROVIDER:null),[re,se]),ce=(0,S.p)(),me=(0,i.useCallback)((()=>{le?ce.open((0,f.o2)({key:"ReportIt_alreadyReportedMessage",defaultTranslatedValue:C.p.ReportIt.already_reported_message})):$(!0)}),[le,ce]);(0,i.useEffect)((()=>{null!==A&&void 0!==A&&A.isReported&&ie(null===A||void 0===A?void 0:A.isReported)}),[null===A||void 0===A?void 0:A.isReported]);const pe=(0,i.useCallback)((()=>{var e,a,l,i;if(se)return;const d=(null===E||void 0===E||null===(e=E.author)||void 0===e?void 0:e.id)||(null===A||void 0===A||null===(a=A.author)||void 0===a?void 0:a.id)||(null===E||void 0===E||null===(l=E.author)||void 0===l?void 0:l.handle)||(null===A||void 0===A||null===(i=A.author)||void 0===i?void 0:i.handle);d&&N("".concat(p.default.PAGES.USER_PROFILE,"/").concat(d))}),[null===A||void 0===A||null===(a=A.author)||void 0===a?void 0:a.handle,null===A||void 0===A||null===(l=A.author)||void 0===l?void 0:l.id,se,null===E||void 0===E||null===(y=E.author)||void 0===y?void 0:y.handle,null===E||void 0===E||null===(g=E.author)||void 0===g?void 0:g.id,N]),Ce=(0,i.useMemo)((()=>{let e=L;return null!==L&&void 0!==L&&L.dateCreated&&(e={...e,dateCreated:(0,_.Z5)({moment:U,dateString:null===L||void 0===L?void 0:L.dateCreated})}),null!==L&&void 0!==L&&L.dateAssigned&&(e={...e,dateAssigned:(0,_.Z5)({moment:U,dateString:null===L||void 0===L?void 0:L.dateAssigned})}),null!==L&&void 0!==L&&L.dueDate&&(e={...e,dueDate:(0,_.Z5)({moment:U,dateString:null===L||void 0===L?void 0:L.dueDate})}),e}),[L,U]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{children:(0,D.jsx)(d.DetailViewHeader,{isBookmarked:M,contextMenuOptions:h,creator:Ce,onBookmark:()=>x(p.default.ICONS.bookmark),onOptionSelect:e=>{(e=>{let{event:a}=e;switch(a.key){case b.eG.ADD_TO_PATHWAY:H(!0);break;case b.eG.ADD_TO_JOURNEY:z(!0);break;case b.eG.ASSIGN:q(!0);break;case b.eG.CARD_INSIGHTS:Z(!0);break;case b.eG.ASSIGN_TO_ME:J(!0);break;case b.eG.REPORT:le||$(!0),me();break;case b.eG.POST_TO_CHANNEL:ae(!0);break;case b.eG.DISMISS_ASSIGNMENT:te(!0);break;case b.eG.CHANGE_AUTHOR:ne(!0)}})({event:e})},title:(null===A||void 0===A?void 0:A.cardTitle)||(null===E||void 0===E?void 0:E.title),isAssignedBy:!R&&!(null===A||void 0===A||null===(V=A.assignment)||void 0===V||!V.assigned_date),isDueDate:!R&&!(null===A||void 0===A||null===(w=A.assignment)||void 0===w||!w.due_at),cardImageUrl:R,isBookmarkCardEnabled:I.isBookmarkCardEnabled,cardAvatarType:ve,isShowCreator:ue||se,onClick:pe,assignedByLabelText:(0,f.oj)({key:"SmartCardDetailViewHeader_assignedByLabel",defaultTranslatedValue:C.p.SmartCardDetailViewHeader.assigned_by_label}),onLabelText:(0,f.oj)({key:"SmartCardDetailViewHeader_onLabel",defaultTranslatedValue:C.p.SmartCardDetailViewHeader.on_label}),DueLabelText:"".concat((0,f.eO)({key:"due",defaultTranslatedValue:C.p.Cards.due}),": "),rootElement:B})}),t.createPortal((0,D.jsx)("div",{children:F?(0,D.jsx)(r.T,{isPathwayModalOpen:F,closePathwayModal:()=>H(!1),cardId:A.id}):null}),document.body),t.createPortal((0,D.jsx)("div",{children:G?(0,D.jsx)(n._,{isModalOpen:G,closeModal:()=>z(!1),cardId:A.id,isPathway:A.cardType===p.default.CARD_TYPE.PATHWAY}):null}),document.body),t.createPortal((0,D.jsx)("div",{children:K?(0,D.jsx)(u.Y,{setPermissions:O,permissions:I,isModalopen:K,closeModal:()=>J(!1),cardData:A,onSubmitSuccess:()=>{P((e=>({...e,isAssigned:!0})))},readableCardType:A.readableCardType}):null}),document.body),t.createPortal((0,D.jsx)("div",{children:Y?(0,D.jsx)(s.Y,{cardId:A.id,isPrivate:!A.isPublic,userInfo:j,isAssignModalOpen:Y,closeAssignModal:()=>q(!1),readableCardType:A.readableCardType}):null}),document.body),t.createPortal((0,D.jsx)("div",{children:oe?(0,D.jsx)(D.Fragment,{}):null}),document.body),t.createPortal((0,D.jsx)("div",{children:Q?(0,D.jsx)(v.R,{isModalOpen:Q,closeModal:()=>Z(!1),cardId:A.id,userInfo:j}):null}),document.body),t.createPortal((0,D.jsx)("div",{children:X?(0,D.jsx)(m.w,{isModalOpen:X,closeModal:()=>$(!1),cardId:null===A||void 0===A?void 0:A.id,setIsReported:ie}):null}),document.body),t.createPortal((0,D.jsx)("div",{children:ee&&null!==A&&void 0!==A&&A.id?(0,D.jsx)(D.Fragment,{}):null}),document.body),t.createPortal((0,D.jsx)("div",{children:de?(0,D.jsx)(c.Y,{closeModal:()=>{te(!1)},isModalOpen:de,cardData:A,onSubmitSuccess:()=>{te(!1),P((e=>({...e,isAssigned:!1})))}}):null}),document.body)]})}}}]);